(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["accountants"],{"00c4":function(t,a,n){"use strict";var e=n("9d35"),s=n.n(e);s.a},"32f3":function(t,a,n){"use strict";var e=n("72ea"),s=n.n(e);s.a},"66cb":function(t,a,n){"use strict";var e=function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("Modal",{attrs:{title:"Confirmation",visible:t.visible,loading:t.loading},on:{success:t.onSuccess,close:t.close}},[t._v(" Are you sure you want to "+t._s(t.state)+" "+t._s(t.userName)+"? ")])},s=[],i=(n("99af"),n("d3b7"),n("78b5")),o={name:"UpdateStatus",components:{Modal:i["a"]},props:{visible:{type:Boolean,default:!1},user:{type:Object,default:function(){return{}}},status:{type:Boolean,default:!1},submission:{type:Function,default:function(){}}},data:function(){return{loading:!1}},computed:{state:function(){return this.status?"activate":"deactivate"},userName:function(){return"".concat(this.user.first_name," ").concat(this.user.last_name)}},methods:{onSuccess:function(){var t=this;this.loading=!0,this.submission(this.user.id,this.status).then((function(){t.$toast.success("Status successfully updated"),t.$emit("success"),t.close(!0)})).catch((function(){t.$toast.error("There was an error while changing status")})).finally((function(){t.loading=!1}))},close:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.loading&&!t||this.$emit("close")}}},c=o,r=n("2877"),u=Object(r["a"])(c,e,s,!1,null,null,null);a["a"]=u.exports},"6d04":function(t,a,n){"use strict";var e=function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("form",{on:{submit:function(a){return a.preventDefault(),t.formSubmit(a)}}},[n("ForeShadow",{attrs:{visible:t.isSubmitting}},[n("SimpleBar",{staticClass:"modal-form-wrapper"},[n("div",{staticClass:"row"},[n("div",{staticClass:"col-9"},[n("InputText",{attrs:{title:"New Password",type:"password",error:t.error,required:""},on:{input:function(a){t.error=""}},model:{value:t.newPassword,callback:function(a){t.newPassword=a},expression:"newPassword"}})],1),n("div",{staticClass:"col-9"},[n("InputText",{attrs:{title:"Confirm Password",error:t.error,type:"password",required:""},on:{input:function(a){t.error=""}},model:{value:t.confirmPassword,callback:function(a){t.confirmPassword=a},expression:"confirmPassword"}})],1)])])],1),n("div",{staticClass:"py-3 d-flex justify-content-start"},[n("Button",{attrs:{type:"submit",loading:t.isSubmitting,color:"primary"}},[t._v(" Update ")])],1)],1)},s=[],i=(n("d3b7"),n("8d3b")),o=n("2612"),c=n("7fb4"),r=n("ad4f"),u=n("d855"),l={name:"SecurityForm",components:{InputText:c["a"],Button:r["a"],ForeShadow:u["a"],SimpleBar:i["a"]},props:{user:{type:Object,default:function(){return{}}}},data:function(){return{newPassword:"",confirmPassword:"",error:"",isSubmitting:!1}},methods:{formSubmit:function(){var t=this;this.newPassword===this.confirmPassword?(this.isSubmitting=!0,Object(o["h"])({token:this.user.token,new_password:this.newPassword}).then((function(){t.$toast.success("Password successfully updated.")})).catch((function(a){t.$toast.error(a,{duration:1e4})})).finally((function(){t.isSubmitting=!1}))):this.error="Password didn't match"}}},d=l,f=n("2877"),h=Object(f["a"])(d,e,s,!1,null,null,null);a["a"]=h.exports},"71f7":function(t,a,n){"use strict";var e=function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("div",[n("form",{on:{submit:function(a){return a.preventDefault(),t.formSubmit(a)}}},[n("ForeShadow",{attrs:{visible:t.loading}},[n("SimpleBar",{staticClass:"modal-form-wrapper"},[n("div",{staticClass:"row"},t._l(t.inputPhones,(function(a,e){return n("div",{key:e,staticClass:"col-12 phone-wrapper"},[n("div",{staticClass:"form-group"},[n("div",{staticClass:"d-flex align-items-center flex-wrap"},[n("div",{staticClass:"flex-grow-1 mr-4"},[n("input",{directives:[{name:"model",rawName:"v-model",value:a.phone,expression:"phone.phone"}],staticClass:"form-control flex-grow-1",class:{"is-primary":a.isPrimary,"is-invalid":a.error},attrs:{placeholder:"Phone",type:"text",required:"",pattern:"\\+?(?:[0-9]{3})?(?:\\s|-)?[0-9]{6,10}"},domProps:{value:a.phone},on:{input:[function(n){n.target.composing||t.$set(a,"phone",n.target.value)},function(a){return t.removeError(e)}]}}),a.error?n("span",{staticClass:"text-danger"},[t._v(" "+t._s(a.error)+" ")]):t._e()]),n("div",{staticClass:"d-flex"},[n("a",{staticClass:"enable-underline mr-3 text-nowrap",class:{"disabled-link":a.isPrimary},attrs:{tabindex:"-1",href:"#"},on:{click:function(a){return a.preventDefault(),t.setAsPrimary(e)}}},[t._v("set as primary ")]),n("a",{staticClass:"enable-underline text-danger",class:{"disabled-link":a.isPrimary},attrs:{tabindex:"-1",href:"#"},on:{click:function(a){return a.preventDefault(),t.removePhone(e)}}},[t._v("remove")])])])])])})),0),n("div",{staticClass:"row"},[n("div",{staticClass:"col-12"},[n("a",{staticClass:"enable-underline",attrs:{href:"#"},on:{click:function(a){return a.preventDefault(),t.addNewPhone(a)}}},[t._v(" Add New ")])])])]),n("div",{staticClass:"py-3 d-flex justify-content-start"},[n("Button",{attrs:{type:"submit",loading:t.loading,disabled:t.loading,color:"primary"}},[t._v(" Update ")])],1)],1)],1)])},s=[],i=(n("4de4"),n("d81d"),n("a434"),n("a9e3"),n("d3b7"),n("25f0"),n("8d3b")),o=n("2ef0"),c=n("2612"),r=n("ad4f"),u=n("d855"),l={name:"Phone",components:{Button:r["a"],ForeShadow:u["a"],SimpleBar:i["a"]},props:{userId:{type:Number,default:null},value:{type:Array,default:function(){return[]}}},data:function(){return{loading:!1,inputPhones:[]}},watch:{value:{handler:function(t){this.inputPhones=t.map((function(t){return{phone:t.phone,isPrimary:!!t.is_primary,error:""}}))},immediate:!0}},methods:{addNewPhone:function(){this.inputPhones.push({phone:"",isPrimary:!1,error:""})},setAsPrimary:function(t){if(this.inputPhones[t].phone){var a=Object(o["findIndex"])(this.inputPhones,"isPrimary");this.inputPhones[a]&&(this.inputPhones[a].isPrimary=!1),this.inputPhones[t].isPrimary=!0}else this.inputPhones[t].error="Cannot set empty value as primary."},formSubmit:function(){var t=this,a=this.inputPhones.filter((function(t){return!!t.phone})).map((function(t){return{phone:t.phone.toString(),is_primary:t.isPrimary?1:0}}));this.loading=!0,Object(c["l"])(this.userId,{phones:a}).then((function(){t.$emit("input",a),t.$emit("updated",a),t.$toast.success("Phone successfully updated")})).catch((function(a){t.$toast.error(a,{duration:1e4})})).finally((function(){t.loading=!1}))},removePhone:function(t){this.inputPhones.splice(t,1)},removeError:function(t){this.inputPhones[t].error=""}}},d=l,f=(n("32f3"),n("2877")),h=Object(f["a"])(d,e,s,!1,null,"01f75095",null);a["a"]=h.exports},"72ea":function(t,a,n){},"7e22":function(t,a,n){"use strict";var e=function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("span",{class:{"font-italic text-gray-dark":""===t.status}},[t._v(" "+t._s(t.status||"N/A")+" ")])},s=[],i={name:"LastOnlineColumn",props:{status:{type:String,default:""}}},o=i,c=n("2877"),r=Object(c["a"])(o,e,s,!1,null,null,null);a["a"]=r.exports},"9d35":function(t,a,n){},a664:function(t,a,n){"use strict";n.r(a);var e=function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("div",[n("ContentHeader",[t._v(" Accountant "),n("template",{slot:"extra"},[n("button",{staticClass:"btn btn-primary ml-2 btn-noborder",on:{click:function(a){t.isCreateFormShown=!0}}},[t._v(" Add Accountant ")])])],2),n("AccountantTable",{on:{delete:t.onDeleteAccountant,edit:t.onEditAccountant}}),n("DeleteAccountant",{attrs:{visible:t.isDeleteModalShown,accountant:t.targetAccountant},on:{close:function(a){t.isDeleteModalShown=!1}}}),n("CreateAccountantForm",{attrs:{visible:t.isCreateFormShown},on:{close:function(a){t.isCreateFormShown=!1}}}),n("UpdateAccountant",{attrs:{"accountant-id":t.targetAccountant.id,visible:t.isEditModalShown},on:{close:function(a){t.isEditModalShown=!1}}})],1)},s=[],i=n("1a1f"),o=function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("div",{staticClass:"mb-4"},[n("UpdateStatus",{attrs:{visible:t.isStatusModalShown,user:t.targetAccountant,status:t.targetAccountant.status,submission:t.updateStatus},on:{success:t.setStatus,close:function(a){t.isStatusModalShown=!1}}}),n("CardBase",{staticClass:"p-4 mb-3"},[n("div",{staticClass:"row"},[n("div",{staticClass:"col-md-3"},[n("InputSelect",{attrs:{title:"Status","option-value":"value","option-text":"name",options:t.statuses},on:{select:function(a){return t.fetchData()}},model:{value:t.dataFilters.status,callback:function(a){t.$set(t.dataFilters,"status",a)},expression:"dataFilters.status"}})],1),n("div",{staticClass:"col-md-3"}),n("div",{staticClass:"col-md-6"},[n("Search",{staticClass:"mt-4 pt-1",attrs:{debounce:500},on:{change:function(a){return t.fetchData()}},model:{value:t.dataFilters.keyword,callback:function(a){t.$set(t.dataFilters,"keyword",a)},expression:"dataFilters.keyword"}})],1)])]),n("CardLoader",{attrs:{"is-loading":t.isLoading}},[n("CardBase",{staticClass:"table-responsive"},[t.accountants.length?n("table",{staticClass:"table table-vcenter m-0"},[n("thead",{staticClass:"bg-gray-lighter"},[n("tr",[n("th",{staticClass:"text-center"},[t._v(" # ")]),n("th",[t._v(" Photo ")]),n("th",{staticClass:"pl-4"},[t._v(" Full Name ")]),n("th",[t._v("Phone")]),n("th",[t._v("Last Online")]),n("th",{staticClass:"text-center"},[t._v(" Status ")]),n("th",{staticStyle:{width:"130px"}})])]),n("tbody",t._l(t.accountants,(function(a,e){return n("tr",{key:a.id},[n("td",{staticClass:"text-center"},[t._v(" "+t._s(e+1)+" ")]),n("td",[n("ImageColumn",{attrs:{url:a.avatar_url}})],1),n("td",{staticClass:"pl-4 ml-4"},[t._v(" "+t._s(a.fullname||a.first_name+" "+a.last_name)+" ")]),n("td",[t._v(" "+t._s(a.phone||"N/a")+" ")]),n("td",[n("LastOnlineCol",{attrs:{status:a.last_online}})],1),n("td",{staticClass:"text-center"},[n("StatusColumn",{attrs:{status:a.is_active},on:{change:function(n){return t.onStatusUpdate(a,n)}}})],1),n("td",[n("div",{staticClass:"d-flex flex-row justify-content-around"},[n("button",{staticClass:"btn btn-sm btn-success btn-noborder",on:{click:function(n){return t.$emit("edit",a)}}},[n("i",{staticClass:"si si-note"})])])])])})),0)]):n("div",{staticClass:"min-height-300 d-flex flex-row justify-content-center align-items-center"},[n("h4",{staticClass:"text-gray-dark font-w300"},[t._v(" No Data Found ")])])])],1),n("div",{staticClass:"d-flex justify-content-between align-items-center flex-wrap"},[n("div",[t._v(" "+t._s(t.pagination.message)+" ")]),n("div",{staticClass:"d-flex justify-content-center"},[n("InputSelect",{attrs:{options:[5,15,25,50,100]},on:{select:function(a){return t.fetchData()}},model:{value:t.pagination.perPage,callback:function(a){t.$set(t.pagination,"perPage",a)},expression:"pagination.perPage"}}),n("Pagination",{attrs:{length:t.pagination.pages,current:t.pagination.current},on:{change:t.changePagination}})],1)])],1)},c=[],r=(n("d81d"),n("15fd")),u=n("5530"),l=n("2ef0"),d=n("9819");function f(t){return Object(d["a"])({url:"accountants",method:"get",params:t,cancelPrevious:!0})}function h(t){return Object(d["a"])({url:"accountants/".concat(t),method:"get"})}function p(t){return Object(d["a"])({url:"accountants",method:"post",data:t})}function m(t,a){return Object(d["a"])({url:"accountants/".concat(t),method:"patch",data:a})}function b(t){return Object(d["a"])({url:"accountants/".concat(t),method:"delete"})}function v(t,a){return Object(d["a"])({url:"accountants/".concat(t,"/status"),method:"patch",data:{is_active:a?1:0}})}var g=n("ab74"),w=n("020b"),C=n("9c4f"),y=n("31e6"),_=n("66cb"),S=n("0af5"),P=n("9a1a"),A=n("0f8e"),x=n("c2cd"),$=n("7e22"),j={name:"AccountantTable",components:{Search:C["a"],InputSelect:S["a"],CardBase:w["a"],Pagination:A["a"],CardLoader:x["a"],ImageColumn:y["a"],StatusColumn:P["a"],LastOnlineCol:$["a"],UpdateStatus:_["a"]},data:function(){return{accountants:[],isLoading:!1,targetAccountant:{},isStatusModalShown:!1,statuses:[{name:"All",value:null},{name:"Active",value:1},{name:"Inactive",value:0}],dataFilters:{status:1,keyword:""},pagination:{pages:1,current:1,perPage:15}}},created:function(){this.$bus.on("reload-accountant-table",this.fetchData),this.fetchData()},beforeDestroy:function(){this.$bus.removeAllListeners("reload-accountant-table")},mounted:function(){var t=this;this.$bus.on("router-link-clicked",(function(){t.isLoading||t.fetchData()}))},methods:{updateStatus:v,setStatus:function(){var t=this.targetAccountant,a=Object(l["findIndex"])(this.accountants,["id",t.id]);this.accountants[a].is_active=t.status?1:0},onStatusUpdate:function(t,a){this.targetAccountant=Object(u["a"])(Object(u["a"])({},t),{},{status:a}),this.isStatusModalShown=!0},fetchData:function(t){var a=this,n=this.dataFilters,e=n.status,s=n.keyword;this.isLoading=!0,f({is_active:e||null,keyword:s||null,page:t||null,per_page:this.pagination.perPage}).then((function(t){var n=t.data,e=t.meta;a.accountants=n.map((function(t){var a=t.phones,n=Object(r["a"])(t,["phones"]);return Object(u["a"])(Object(u["a"])({},n),{},{phone:Object(g["g"])(a)})})),a.pagination=Object(g["f"])(e),a.isLoading=!1})).catch((function(t){"request-cancel"!==t&&(a.$toast.error("There was an error while fetching data."),a.isLoading=!1)}))},changePagination:function(t){this.pagination.current=t,this.fetchData(t)}}},O=j,k=n("2877"),D=Object(k["a"])(O,o,c,!1,null,null,null),F=D.exports,L=function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("Modal",{attrs:{title:"Create Accountant",visible:t.visible,"hide-controls":""},on:{closed:t.reset,close:t.close}},[n("User",{staticClass:"fade-in",attrs:{loading:t.isLoading},on:{submit:t.createAccountant},model:{value:t.accountant,callback:function(a){t.accountant=a},expression:"accountant"}})],1)},T=[],M=(n("99af"),n("d3b7"),n("78b5")),E=n("47a4"),B={name:"CreateAccountantForm",components:{Modal:M["a"],User:E["a"]},props:{visible:{type:Boolean,default:!1}},data:function(){return{accountant:{},isLoading:!1,isUserFormShown:!0}},methods:{createAccountant:function(){var t=this;this.isLoading=!0;var a=this.accountant,n=a.first_name,e=a.last_name;p(Object(u["a"])(Object(u["a"])({},a),{},{fullname:"".concat(n," ").concat(e)})).then((function(){t.$bus.emit("reload-accountant-table"),t.$toast.success("Accountant Successfully Created")})).catch((function(a){t.$toast.error(a)})).finally((function(){t.isLoading=!1,t.close()}))},close:function(){this.isLoading||this.$emit("close")},reset:function(){this.accountant={},this.isLoading=!1,this.isUserFormShown=!0}}},I=B,U=(n("00c4"),Object(k["a"])(I,L,T,!1,null,"62ca799c",null)),N=U.exports,q=function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("Modal",{attrs:{title:"Edit Accountant",visible:t.visible,"hide-controls":""},on:{close:t.close,closed:t.onClosed}},[n("CardLoader",{attrs:{"is-loading":t.isFetchingData}},[n("Tabs",{staticClass:"mt-n4",attrs:{current:t.activeTab,tabs:["General","Phone","Security"]},on:{change:t.changeTab}},[n("div",{staticClass:"pt-4"},[t.isTabActive("General")?n("User",{staticClass:"fade-in",attrs:{loading:t.isSubmitting,"edit-mode":""},on:{submit:t.updateAccountant},model:{value:t.accountant,callback:function(a){t.accountant=a},expression:"accountant"}}):t.isTabActive("Phone")?n("Phone",{staticClass:"fade-in",attrs:{"user-id":t.accountant.user_id},on:{updated:t.reloadTable},model:{value:t.accountant.phones,callback:function(a){t.$set(t.accountant,"phones",a)},expression:"accountant.phones"}}):t.isTabActive("Security")?n("Security",{staticClass:"fade-in",attrs:{user:{id:t.accountant.user_id,token:t.accountant.token}}}):t._e()],1)])],1)],1)},G=[],H=(n("a9e3"),n("fa43")),J=n("71f7"),z=n("6d04"),K=n("a1be"),Q={name:"UpdateAccountant",components:{Modal:M["a"],Tabs:H["a"],User:E["a"],Phone:J["a"],Security:z["a"],CardLoader:x["a"]},props:{visible:{type:Boolean,default:!1},accountantId:{type:Number,default:null}},data:function(){return{activeTab:"General",isFetchingData:!1,isSubmitting:!1,accountant:{}}},watch:{visible:function(t){t&&this.fetchData()}},methods:{fetchData:function(){var t=this;this.isFetchingData=!0,h(this.accountantId).then((function(a){t.accountant=Object(K["d"])(a),t.activeTab="General"})).catch((function(){t.close(),t.$toast.error("There was an error while fetching accountant data!")})).finally((function(){t.isFetchingData=!1}))},updateAccountant:function(){var t=this;this.isSubmitting=!0;var a=this.accountant,n=a.first_name,e=a.last_name;m(this.accountantId,Object(u["a"])(Object(u["a"])({},a),{},{fullname:"".concat(n," ").concat(e)})).then((function(){t.$toast.success("Accountant successfully updated"),t.$bus.emit("reload-accountant-table")})).catch((function(a){t.$toast.error(a)})).finally((function(){t.isSubmitting=!1}))},close:function(){this.isSubmitting||this.$emit("close")},onClosed:function(){this.activeTab=""},isTabActive:function(t){return this.activeTab===t},changeTab:function(t){this.isSubmitting||(this.activeTab=t)},reloadTable:function(){this.$bus.emit("reload-accountant-table")}}},R=Q,V=Object(k["a"])(R,q,G,!1,null,null,null),W=V.exports,X=function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("Modal",{attrs:{title:"Delete Accountant",visible:t.visible,loading:t.isLoading},on:{close:t.onClose,success:t.deleteAccountant}},[t._v(" Are you sure you want to delete "+t._s(t.accountant.first_name+" "+t.accountant.last_name)+"? ")])},Y=[],Z={name:"DeleteAccountant",components:{Modal:M["a"]},props:{visible:{type:Boolean,default:!1},accountant:{type:Object,default:function(){return{}}}},data:function(){return{isLoading:!1}},methods:{deleteAccountant:function(){var t=this;this.isLoading=!0,b(this.accountant.id).then((function(){t.$bus.emit("reload-accountant-table"),t.$toast.success("Successfully Deleted!")})).catch((function(a){var n=a||"There was an error while deleting accountant!";t.$toast.error(n)})).finally((function(){t.isLoading=!1,t.onClose()}))},onClose:function(){this.isLoading||this.$emit("close")}}},tt=Z,at=Object(k["a"])(tt,X,Y,!1,null,null,null),nt=at.exports,et={name:"Accountants",components:{CreateAccountantForm:N,AccountantTable:F,ContentHeader:i["a"],UpdateAccountant:W,DeleteAccountant:nt},data:function(){return{isCreateFormShown:!1,isDeleteModalShown:!1,isStatusModalShown:!1,isEditModalShown:!1,targetAccountant:{}}},methods:{onDeleteAccountant:function(t){this.targetAccountant=t,this.isDeleteModalShown=!0},onEditAccountant:function(t){this.targetAccountant=t,this.isEditModalShown=!0}}},st=et,it=Object(k["a"])(st,e,s,!1,null,null,null);a["default"]=it.exports},fa43:function(t,a,n){"use strict";var e=function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("div",{staticClass:"block mb-0"},[n("ul",{staticClass:"nav nav-tabs nav-tabs-alt",attrs:{"data-toggle":"tabs",role:"tablist"}},t._l(t.tabs,(function(a,e){return n("li",{key:e,staticClass:"nav-item"},[n("a",{staticClass:"nav-link text-capitalize",class:{active:t.current===a},attrs:{href:"#"},on:{click:function(n){return n.preventDefault(),t.$emit("change",a)}}},[t._v(t._s(a))])])})),0),n("div",{staticClass:"tab-content"},[t._t("default")],2)])},s=[],i={props:{current:{type:String,default:""},tabs:{type:Array,default:function(){return[]}}}},o=i,c=n("2877"),r=Object(c["a"])(o,e,s,!1,null,null,null);a["a"]=r.exports}}]);