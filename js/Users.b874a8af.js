(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Users"],{"32f3":function(t,e,s){"use strict";var a=s("72ea"),i=s.n(a);i.a},4468:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("ContentHeader",[t._v(" Users ")]),s("UpdateUser",{attrs:{"user-id":t.targetUser.id,visible:t.isEditModalShown},on:{close:function(e){t.isEditModalShown=!1}}}),s("UserTable",{on:{edit:t.onEditUser}})],1)},i=[],n=s("1a1f"),r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"mb-4"},[s("UpdateStatus",{attrs:{visible:t.isStatusModalShown,user:t.targetUser,status:t.targetUser.status,submission:t.updateStatus},on:{success:t.setStatus,close:function(e){t.isStatusModalShown=!1}}}),s("CardBase",{staticClass:"p-4 mb-3"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-md-3"},[s("InputSelect",{attrs:{title:"Status","option-value":"value","option-text":"name",options:t.statuses},on:{select:function(e){return t.fetchData()}},model:{value:t.dataFilters.status,callback:function(e){t.$set(t.dataFilters,"status",e)},expression:"dataFilters.status"}})],1),s("div",{staticClass:"col-md-3"}),s("div",{staticClass:"col-md-6"},[s("Search",{staticClass:"mt-4 pt-1",attrs:{debounce:500},on:{change:function(e){return t.fetchData()}},model:{value:t.dataFilters.keyword,callback:function(e){t.$set(t.dataFilters,"keyword",e)},expression:"dataFilters.keyword"}})],1)])]),s("CardLoader",{attrs:{"is-loading":t.isLoading}},[s("CardBase",{staticClass:"table-responsive"},[t.users.length?s("table",{staticClass:"table table-vcenter m-0"},[s("thead",{staticClass:"bg-gray-lighter"},[s("tr",[s("th",{staticClass:"text-center"},[t._v(" # ")]),s("th",[t._v(" Photo ")]),s("th",{staticClass:"pl-4"},[t._v(" First Name ")]),s("th",[t._v("Last Name")]),s("th",[t._v("Email")]),s("th",[t._v("Last Online")]),s("th",{staticClass:"text-center"},[t._v(" Status ")]),s("th",{staticStyle:{width:"20%"}},[t._v(" Organization ")]),s("th",{staticStyle:{width:"130px"}})])]),s("tbody",t._l(t.users,(function(e,a){return s("tr",{key:e.id},[s("td",{staticClass:"text-center"},[t._v(" "+t._s(a+1)+" ")]),s("td",[s("ImageColumn",{attrs:{url:e.avatar_url}})],1),s("td",{staticClass:"pl-4 ml-4"},[t._v(" "+t._s(e.first_name)+" ")]),s("td",[t._v(t._s(e.last_name))]),s("td",[t._v(t._s(e.email))]),s("td",[s("LastOnlineCol",{attrs:{status:e.last_online}})],1),s("td",{staticClass:"text-center"},[s("StatusColumn",{attrs:{status:e.is_active},on:{change:function(s){return t.onStatusUpdate(e,s)}}})],1),s("td",[t._v(t._s(e.organization.name))]),s("td",[s("div",{staticClass:"d-flex flex-row justify-content-around"},[s("button",{staticClass:"btn btn-sm btn-success btn-noborder",attrs:{title:"edit"},on:{click:function(s){return t.$emit("edit",e)}}},[s("i",{staticClass:"si si-note"})])])])])})),0)]):s("div",{staticClass:"min-height-300 d-flex flex-row justify-content-center align-items-center"},[s("h4",{staticClass:"text-gray-dark font-w300"},[t._v(" No Data Found ")])])])],1),s("div",{staticClass:"d-flex justify-content-between align-items-center flex-wrap"},[s("div",[t._v(" "+t._s(t.pagination.message)+" ")]),s("div",{staticClass:"d-flex justify-content-center"},[s("InputSelect",{attrs:{options:[5,15,25,50,100]},on:{select:function(e){return t.fetchData()}},model:{value:t.pagination.perPage,callback:function(e){t.$set(t.pagination,"perPage",e)},expression:"pagination.perPage"}}),s("Pagination",{attrs:{length:t.pagination.pages,current:t.pagination.current},on:{change:t.changePagination}})],1)])],1)},o=[],l=s("5530"),c=s("2ef0"),u=s("ab74"),d=s("2612"),h=s("020b"),p=s("0af5"),m=s("0f8e"),f=s("9c4f"),v=s("9a1a"),b=s("c2cd"),g=s("66cb"),C=s("7e22"),_=s("31e6"),y={name:"UserTable",components:{Search:f["a"],ImageColumn:_["a"],Pagination:m["a"],InputSelect:p["a"],CardBase:h["a"],CardLoader:b["a"],StatusColumn:v["a"],LastOnlineCol:C["a"],UpdateStatus:g["a"]},data(){return{users:[],isLoading:!1,isStatusModalShown:!1,targetUser:{},statuses:[{name:"All",value:""},{name:"Active",value:1},{name:"Inactive",value:0}],dataFilters:{status:"",keyword:""},pagination:{pages:1,current:1,perPage:15}}},created(){this.$bus.on("reload-user-table",this.fetchData),this.fetchData()},beforeDestroy(){this.$bus.removeAllListeners("reload-user-table")},mounted(){this.$bus.on("router-link-clicked",()=>{this.fetchData()})},methods:{updateStatus:d["n"],setStatus(){const t=this.targetUser,e=Object(c["findIndex"])(this.users,["id",t.id]);this.users[e].is_active=t.status?1:0},onStatusUpdate(t,e){this.targetUser=Object(l["a"])(Object(l["a"])({},t),{},{status:e}),this.isStatusModalShown=!0},fetchData(t=null){const{status:e,keyword:s}=this.dataFilters;this.isLoading=!0,Object(d["e"])({page:t,is_active:e||null,keyword:s||null,per_page:this.pagination.perPage}).then(({data:t,meta:e})=>{this.users=t,this.pagination=Object(u["f"])(e),this.isLoading=!1}).catch(t=>{"request-cancel"!==t&&(this.$toast.error("There was an error while fetching data."),this.isLoading=!1)})},changePagination(t){this.pagination.current=t,this.fetchData(t)}}},w=y,S=s("2877"),P=Object(S["a"])(w,r,o,!1,null,null,null),x=P.exports,U=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("Modal",{attrs:{title:"Edit User",visible:t.visible,"hide-controls":""},on:{close:t.close,closed:t.onClosed}},[s("CardLoader",{attrs:{"is-loading":t.isFetchingData}},[s("Tabs",{staticClass:"mt-n4",attrs:{current:t.activeTab,tabs:["General","Phone"]},on:{change:t.changeTab}},[s("div",{staticClass:"pt-4"},[t.isTabActive("General")?s("User",{staticClass:"fade-in",attrs:{loading:t.isSubmitting,"edit-mode":""},on:{submit:t.updateUser},model:{value:t.user,callback:function(e){t.user=e},expression:"user"}}):t.isTabActive("Phone")?s("Phone",{staticClass:"fade-in",attrs:{"user-id":t.user.id},model:{value:t.user.phones,callback:function(e){t.$set(t.user,"phones",e)},expression:"user.phones"}}):t._e()],1)])],1)],1)},$=[],k=s("78b5"),j=s("fa43"),O=s("47a4"),D=s("71f7"),T=s("a1be"),E={name:"UpdateUser",components:{Modal:k["a"],Tabs:j["a"],User:O["a"],Phone:D["a"],CardLoader:b["a"]},props:{visible:{type:Boolean,default:!1},userId:{type:Number,default:null}},data(){return{activeTab:"",isFetchingData:!1,isSubmitting:!1,user:{}}},watch:{visible(t){t&&this.fetchData()}},methods:{fetchData(){this.isFetchingData=!0,Object(d["c"])(this.userId).then(t=>{this.user=Object(T["d"])(t),this.activeTab="General"}).catch(()=>{this.close(),this.$toast.error("There was an error while fetching user data!")}).finally(()=>{this.isFetchingData=!1})},updateUser(){this.isSubmitting=!0,Object(d["o"])(this.userId,this.user).then(()=>{this.$toast.success("User successfully updated"),this.$bus.emit("reload-user-table")}).catch(t=>{this.$toast.error(t,{duration:1e4})}).finally(()=>{this.isSubmitting=!1})},isTabActive(t){return this.activeTab===t},close(){this.isSubmitting||this.$emit("close")},onClosed(){this.activeTab=""},changeTab(t){this.isSubmitting||(this.activeTab=t)}}},F=E,L=Object(S["a"])(F,U,$,!1,null,null,null),I=L.exports,A={name:"Index",components:{ContentHeader:n["a"],UserTable:x,UpdateUser:I},data(){return{targetUser:{},isEditModalShown:!1}},methods:{onEditUser(t){this.targetUser=t,this.isEditModalShown=!0}}},M=A,N=Object(S["a"])(M,a,i,!1,null,null,null);e["default"]=N.exports},"66cb":function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("Modal",{attrs:{title:"Confirmation",visible:t.visible,loading:t.loading},on:{success:t.onSuccess,close:t.close}},[t._v(" Are you sure you want to "+t._s(t.state)+" "+t._s(t.userName)+"? ")])},i=[],n=s("78b5"),r={name:"UpdateStatus",components:{Modal:n["a"]},props:{visible:{type:Boolean,default:!1},user:{type:Object,default:()=>({})},status:{type:Boolean,default:!1},submission:{type:Function,default:()=>{}}},data(){return{loading:!1}},computed:{state(){return this.status?"activate":"deactivate"},userName(){return`${this.user.first_name} ${this.user.last_name}`}},methods:{onSuccess(){this.loading=!0,this.submission(this.user.id,this.status).then(()=>{this.$toast.success("Status successfully updated"),this.$emit("success"),this.close(!0)}).catch(()=>{this.$toast.error("There was an error while changing status")}).finally(()=>{this.loading=!1})},close(t=!1){this.loading&&!t||this.$emit("close")}}},o=r,l=s("2877"),c=Object(l["a"])(o,a,i,!1,null,null,null);e["a"]=c.exports},"71f7":function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("form",{on:{submit:function(e){return e.preventDefault(),t.formSubmit(e)}}},[s("ForeShadow",{attrs:{visible:t.loading}},[s("SimpleBar",{staticClass:"modal-form-wrapper"},[s("div",{staticClass:"row"},t._l(t.inputPhones,(function(e,a){return s("div",{key:a,staticClass:"col-12 phone-wrapper"},[s("div",{staticClass:"form-group"},[s("div",{staticClass:"d-flex align-items-center flex-wrap"},[s("div",{staticClass:"flex-grow-1 mr-4"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.phone,expression:"phone.phone"}],staticClass:"form-control flex-grow-1",class:{"is-primary":e.isPrimary,"is-invalid":e.error},attrs:{placeholder:"Phone",type:"text",required:"",pattern:"\\+?(?:[0-9]{3})?(?:\\s|-)?[0-9]{6,10}"},domProps:{value:e.phone},on:{input:[function(s){s.target.composing||t.$set(e,"phone",s.target.value)},function(e){return t.removeError(a)}]}}),e.error?s("span",{staticClass:"text-danger"},[t._v(" "+t._s(e.error)+" ")]):t._e()]),s("div",{staticClass:"d-flex"},[s("a",{staticClass:"enable-underline mr-3 text-nowrap",class:{"disabled-link":e.isPrimary},attrs:{tabindex:"-1",href:"#"},on:{click:function(e){return e.preventDefault(),t.setAsPrimary(a)}}},[t._v("set as primary ")]),s("a",{staticClass:"enable-underline text-danger",class:{"disabled-link":e.isPrimary},attrs:{tabindex:"-1",href:"#"},on:{click:function(e){return e.preventDefault(),t.removePhone(a)}}},[t._v("remove")])])])])])})),0),s("div",{staticClass:"row"},[s("div",{staticClass:"col-12"},[s("a",{staticClass:"enable-underline",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.addNewPhone(e)}}},[t._v(" Add New ")])])])]),s("div",{staticClass:"py-3 d-flex justify-content-start"},[s("Button",{attrs:{type:"submit",loading:t.loading,disabled:t.loading,color:"primary"}},[t._v(" Update ")])],1)],1)],1)])},i=[],n=(s("25f0"),s("8d3b")),r=s("2ef0"),o=s("2612"),l=s("ad4f"),c=s("d855"),u={name:"Phone",components:{Button:l["a"],ForeShadow:c["a"],SimpleBar:n["a"]},props:{userId:{type:Number,default:null},value:{type:Array,default:()=>[]}},data(){return{loading:!1,inputPhones:[]}},watch:{value:{handler(t){this.inputPhones=t.map(t=>({phone:t.phone,isPrimary:!!t.is_primary,error:""}))},immediate:!0}},methods:{addNewPhone(){this.inputPhones.push({phone:"",isPrimary:!1,error:""})},setAsPrimary(t){if(!this.inputPhones[t].phone)return void(this.inputPhones[t].error="Cannot set empty value as primary.");const e=Object(r["findIndex"])(this.inputPhones,"isPrimary");this.inputPhones[e]&&(this.inputPhones[e].isPrimary=!1),this.inputPhones[t].isPrimary=!0},formSubmit(){const t=this.inputPhones.filter(t=>!!t.phone).map(t=>({phone:t.phone.toString(),is_primary:t.isPrimary?1:0}));this.loading=!0,Object(o["l"])(this.userId,{phones:t}).then(()=>{this.$emit("input",t),this.$emit("updated",t),this.$toast.success("Phone successfully updated")}).catch(t=>{this.$toast.error(t,{duration:1e4})}).finally(()=>{this.loading=!1})},removePhone(t){this.inputPhones.splice(t,1)},removeError(t){this.inputPhones[t].error=""}}},d=u,h=(s("32f3"),s("2877")),p=Object(h["a"])(d,a,i,!1,null,"01f75095",null);e["a"]=p.exports},"72ea":function(t,e,s){},"7e22":function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{class:{"font-italic text-gray-dark":""===t.status}},[t._v(" "+t._s(t.status||"N/A")+" ")])},i=[],n={name:"LastOnlineColumn",props:{status:{type:String,default:""}}},r=n,o=s("2877"),l=Object(o["a"])(r,a,i,!1,null,null,null);e["a"]=l.exports},fa43:function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"block mb-0"},[s("ul",{staticClass:"nav nav-tabs nav-tabs-alt",attrs:{"data-toggle":"tabs",role:"tablist"}},t._l(t.tabs,(function(e,a){return s("li",{key:a,staticClass:"nav-item"},[s("a",{staticClass:"nav-link text-capitalize",class:{active:t.current===e},attrs:{href:"#"},on:{click:function(s){return s.preventDefault(),t.$emit("change",e)}}},[t._v(t._s(e))])])})),0),s("div",{staticClass:"tab-content"},[t._t("default")],2)])},i=[],n={props:{current:{type:String,default:""},tabs:{type:Array,default:()=>[]}}},r=n,o=s("2877"),l=Object(o["a"])(r,a,i,!1,null,null,null);e["a"]=l.exports}}]);