(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["paymentRequest"],{"066a":function(t,e,a){"use strict";var s=a("aa08"),n=a.n(s);n.a},"11f2":function(t,e,a){},"4a3b":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"text-capitalize"},[a("span",{staticClass:"d-inline-block status rounded-circle mr-2",class:t.spanClass}),t._v(" "+t._s(t.status.toLowerCase())+" ")])},n=[];const i={ACCEPTED:"success",HOLD:"warning",PENDING:"warning",CANCELLED:"danger",REJECTED:"danger"};var r={name:"TransactionStatusColumn",props:{status:{type:String,default:"ACCEPTED"}},computed:{spanClass(){return"bg-"+i[this.status]}}},o=r,u=(a("066a"),a("2877")),l=Object(u["a"])(o,s,n,!1,null,"3f9ca497",null);e["a"]=l.exports},9780:function(t,e,a){"use strict";var s=a("11f2"),n=a.n(s);n.a},aa08:function(t,e,a){},dc50:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("ContentHeader",[t._v(" Withdrawal Request ")]),a("RequestTable",{on:{view:t.viewRequestDetail}}),t.targetRequest.customer?a("RequestDetail",{attrs:{request:t.targetRequest,visible:t.isDetailModalShown},on:{close:function(e){t.isDetailModalShown=!1}}}):t._e()],1)},n=[],i=a("5530"),r=a("2f62"),o=a("1a1f"),u=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Modal",{attrs:{title:"Request Detail",visible:t.visible},on:{close:t.close}},[a("div",{staticClass:"request-detail-wrapper"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-12"},[a("strong",[t._v(" "+t._s(t._f("formatName")(t.customer))+" ")]),t._v(" "+t._s("PENDING"===t.request.status?"has ":"had ")+" requested to withdraw ")])]),a("table",{staticClass:"table table-borderless mt-4 mb-0"},[a("tbody",[a("tr",[a("td",{staticStyle:{width:"40%"}},[t._v(" Account Number: ")]),a("td",[a("strong",[t._v(" "+t._s(t.request.customer.account_number)+" ")])])]),a("tr",[a("td",[t._v("Request Amount:")]),a("td",[a("strong",[t._v(" "+t._s(t._f("formatCurrency")(t.request.amount))+" ")])])]),a("tr",[a("td",[t._v("Status:")]),a("td",[a("strong",[t._v(" "+t._s(t.request.status)+" ")])])]),a("tr",[a("td",[t._v("Customer Remark:")]),a("td",[a("strong",[t._v(" "+t._s(t.request.description||"N/A")+" ")])])]),a("tr",[a("td",[t._v("Created at:")]),a("td",[a("strong",[t._v(" "+t._s(t.request.requested_date_np+" "+t.request.requested_time)+" ")])])]),"ACCEPTED"===t.request.status?a("tr",[a("td",[t._v("Accepted at:")]),a("td",[a("strong",[t._v(" "+t._s(t.request.approved_date_np+" "+t.request.approved_time)+" ")])])]):"REJECTED"===t.request.status?a("tr",[a("td",[t._v("Rejected at:")]),a("td",[a("strong",[t._v(" "+t._s(t.request.rejected_date_np+" "+t.request.rejected_time)+" ")])])]):t._e()])])]),a("template",{slot:"footer"},[a("span")])],2)},l=[],c=a("78b5"),d={name:"RequestDetail",components:{Modal:c["a"]},props:{visible:{type:Boolean,default:!1},request:{type:Object,default:()=>({})}},data(){return{isSubmitting:!1}},computed:{customer(){return this.request.customer?this.request.customer:{amounts:{}}}},methods:{close(t){!t&&this.isSubmitting||this.$emit("close")}}},p=d,m=(a("9780"),a("2877")),h=Object(m["a"])(p,u,l,!1,null,null,null),f=h.exports,g=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"mb-4"},[a("CardBase",{staticClass:"p-4 mb-3"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-3"},[a("InputSelect",{attrs:{title:"Status",options:["All","Pending","Accepted","Rejected"]},on:{select:function(e){return t.fetchData()}},model:{value:t.dataFilters.status,callback:function(e){t.$set(t.dataFilters,"status",e)},expression:"dataFilters.status"}})],1),a("div",{staticClass:"col-md-3"},[a("InputNumberRange",{attrs:{title:"Amount Range",debounce:500},on:{change:function(e){return t.fetchData()}},model:{value:t.dataFilters.amountRange,callback:function(e){t.$set(t.dataFilters,"amountRange",e)},expression:"dataFilters.amountRange"}})],1),a("div",{staticClass:"col-md-6"},[a("Search",{staticClass:"mt-4 pt-1",attrs:{debounce:500},on:{change:function(e){return t.fetchData()}},model:{value:t.dataFilters.keyword,callback:function(e){t.$set(t.dataFilters,"keyword",e)},expression:"dataFilters.keyword"}})],1)])]),a("CardLoader",{attrs:{"is-loading":t.isFetchingData}},[a("CardBase",{staticClass:"table-responsive"},[t.requests.length?a("table",{staticClass:"table table-vcenter m-0"},[a("thead",{staticClass:"bg-gray-lighter"},[a("tr",[a("th",{staticClass:"text-center"},[t._v(" # ")]),a("th",[t._v(" Customer Name ")]),a("th",[t._v(" A/C Number ")]),a("th",[t._v(" Amount ")]),a("th",[t._v(" Status ")]),a("th",{staticStyle:{width:"15%"}},[t._v(" Created At ")]),a("th",{staticStyle:{width:"10%"}})])]),a("tbody",t._l(t.requests,(function(e,s){return a("tr",{key:e.id},[a("td",{staticClass:"text-center"},[t._v(" "+t._s(s+1)+" ")]),a("td",[t._v(" "+t._s(e.customer.first_name+" "+e.customer.last_name)+" ")]),a("td",[t._v(" "+t._s(""+e.customer.account_number)+" ")]),a("td",[t._v(" "+t._s(t._f("formatCurrency")(e.amount))+" ")]),a("td",[a("StatusColumn",{attrs:{status:e.status}})],1),a("td",[t._v(" "+t._s(e.requested_date_np+" "+e.requested_time)+" ")]),a("td",[a("div",{staticClass:"d-flex flex-row justify-content-around"},[a("button",{staticClass:"btn btn-sm btn-noborder text-info",attrs:{title:"View Request"},on:{click:function(a){return t.$emit("view",e)}}},[a("i",{staticClass:"si si-info font-size-h4"})])])])])})),0)]):a("div",{staticClass:"min-height-300 d-flex flex-row justify-content-center align-items-center"},[a("h4",{staticClass:"text-gray-dark font-w300"},[t._v(" No Request Found ")])])])],1),a("div",{staticClass:"d-flex justify-content-between align-items-center flex-wrap"},[a("div",[t._v(" "+t._s(t.pagination.message)+" ")]),a("div",{staticClass:"d-flex justify-content-center"},[a("InputSelect",{attrs:{options:[5,15,25,50,100]},on:{select:function(e){return t.fetchData()}},model:{value:t.pagination.perPage,callback:function(e){t.$set(t.pagination,"perPage",e)},expression:"pagination.perPage"}}),a("Pagination",{attrs:{length:t.pagination.pages,current:t.pagination.current},on:{change:t.changePagination}})],1)])],1)},v=[],b=a("2ef0"),_=a("9819");function C(t){return Object(_["a"])({url:"/payment-requests",method:"get",params:t,cancelPrevious:!0})}var q=a("ab74"),w=a("9c4f"),R=a("020b"),y=a("c2cd"),D=a("0af5"),S=a("0f8e"),x=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("InputBase",{attrs:{title:t.title,error:t.error},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.id,n=e.isInvalid;return[a("div",{staticClass:"input-group"},[a("input",{ref:"inputFrom",staticClass:"form-control",class:{"is-invalid":n},attrs:{id:s,type:"number",min:t.min,max:t.max,placeholder:"From"},domProps:{value:t.value.from},on:{input:t.updateRange}}),a("div",{staticClass:"input-group-prepend input-group-append"},[a("span",{staticClass:"input-group-text font-w600"},[t._v("to")])]),a("input",{ref:"inputTo",staticClass:"form-control",class:{"is-invalid":n},attrs:{type:"number",min:t.min,max:t.max,placeholder:"To"},domProps:{value:t.value.to},on:{input:t.updateRange}})])]}}])})},j=[],F=a("850b"),A={name:"InputNumberRange",components:{InputBase:F["a"]},props:{title:{type:String,default:""},value:{type:Object,default:()=>({from:null,to:null})},min:{type:String,default:"0"},max:{type:String,default:"10000"},error:{type:String,default:""},debounce:{type:Number,default:0}},created(){this.debounce&&(this.onChange=Object(b["debounce"])(this.onChange,this.debounce))},methods:{updateRange(){const t=this.$refs.inputFrom.value,e=this.$refs.inputTo.value,a={from:t?+t:"",to:e?+e:""};this.$emit("input",a),this.onChange(a)},onChange(t){this.$emit("change",t)}}},E=A,$=Object(m["a"])(E,x,j,!1,null,"1f996d94",null),k=$.exports,P=a("4a3b"),N={name:"RequestTable",components:{InputNumberRange:k,StatusColumn:P["a"],InputSelect:D["a"],CardLoader:y["a"],Pagination:S["a"],CardBase:R["a"],Search:w["a"]},data(){return{requests:[],dataFilters:{status:"All",amountRange:{},keyword:""},pagination:{pages:1,current:1,perPage:15},isFetchingData:!1}},created(){this.$bus.on("reload-request-table",this.fetchData),this.$bus.on("change-payment-request-status",this.changeRequestStatus),this.fetchData()},beforeDestroy(){this.$bus.removeAllListeners("reload-request-table"),this.$bus.removeAllListeners("change-payment-request-status")},mounted(){this.$bus.on("router-link-clicked",()=>{this.isFetchingData||this.fetchData()})},methods:{getFilters(){const{status:t,amountRange:e,keyword:a}=this.dataFilters;return{status:"All"===t?null:t.toUpperCase(),min_amount:e.from||0,max_amount:e.to||null,keyword:a||null}},fetchData(t=null){this.isFetchingData=!0;const e=Object(i["a"])(Object(i["a"])({},this.getFilters()),{},{page:t,per_page:this.pagination.perPage});C(e).then(({data:t,meta:e})=>{this.requests=t,this.pagination=Object(q["f"])(e),this.isFetchingData=!1}).catch(t=>{"request-cancel"!==t&&(this.$toast.error("There was an error while fetching data."),this.isFetchingData=!1)})},changeRequestStatus(t,e){const a=Object(b["findIndex"])(this.requests,["id",t]);this.requests[a].status=e},changePagination(t){this.pagination.current=t,this.fetchData(t)},isActionable(t){return"PENDING"===t.status}}},O=N,M=Object(m["a"])(O,g,v,!1,null,null,null),I=M.exports,T={name:"PaymentRequest",components:{RequestTable:I,RequestDetail:f,ContentHeader:o["a"]},data(){return{isSubmitting:!1,isDetailModalShown:!1,isAcceptModalShown:!1,isRejectModalShown:!1,targetRequest:{}}},created(){this.fetchSearchableCollectors()},methods:Object(i["a"])(Object(i["a"])({},Object(r["b"])(["fetchSearchableCollectors"])),{},{viewRequestDetail(t){this.targetRequest=t,this.isDetailModalShown=!0},openAcceptModal(){this.isDetailModalShown=!1,this.isAcceptModalShown=!0},openRejectModal(){this.isDetailModalShown=!1,this.isRejectModalShown=!0}})},L=T,B=Object(m["a"])(L,s,n,!1,null,null,null);e["default"]=B.exports}}]);