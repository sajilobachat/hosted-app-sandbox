(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["collectors-approval"],{"020b":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"block custom-border-radius custom-box-shadow"},[t._t("default")],2)},o=[],s={name:"CardBase"},i=s,r=a("2877"),c=Object(r["a"])(i,n,o,!1,null,"6a27c542",null);e["a"]=c.exports},"103f":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("ContentHeader",[t._v(" Approvals ")]),a("Modal",{attrs:{visible:t.isApproveModalVisible,loading:t.isApproving,title:"Confirmation"},on:{success:t.approve,close:t.closeApproveModal}},[t._v(" Are you sure you want to approve collection by "+t._s(t.targetCollection.collectorName)+"? ")]),a("CardLoader",{attrs:{"is-loading":t.isFetchingData}},[a("ApprovalTable",{attrs:{approvals:t.approvals},on:{approve:t.onApproveCollection}})],1)],1)},o=[],s=(a("a434"),a("d3b7"),a("2ef0")),i=a("f4f7"),r=a("7ede"),c=a("1a1f"),l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("CardBase",{staticClass:"mb-4 px-4 pb-3",staticStyle:{"padding-top":"30px"}},[t.approvals.length?a("table",{staticClass:"table table-vcenter m-0 table-borderless"},[a("thead",{staticClass:"bg-gray-lighter"},[a("tr",[a("th",{staticClass:"text-center"},[t._v(" # ")]),a("th",{staticStyle:{width:"20%"}},[t._v(" Collector ")]),a("th",[t._v(" From ")]),a("th",[t._v(" To ")]),a("th",[t._v(" Deposit ")]),a("th",[t._v(" Withdraw ")]),a("th",[t._v(" Loan ")]),a("th",[t._v(" Total ")]),a("th",{staticClass:"text-center",staticStyle:{width:"110px"}})])]),t._l(t.approvals,(function(e,n){return a("tr",{key:e.id},[a("td",{staticClass:"text-center"},[t._v(" "+t._s(n+1)+" ")]),a("td",[t._v(" "+t._s(e.first_name+" "+e.last_name)+" ")]),a("td",[e.start_date?a("span",[t._v(" "+t._s(e.start_date)+" ")]):a("span",{staticClass:"font-italic text-gray"},[t._v(" N/A ")])]),a("td",[e.end_date?a("span",[t._v(" "+t._s(e.end_date)+" ")]):a("span",{staticClass:"font-italic text-gray"},[t._v(" N/A ")])]),a("td",{staticClass:"text-success"},[t._v(" "+t._s(t._f("formatCurrency")(e.amounts.credit_amount))+" ")]),a("td",{staticClass:"text-danger"},[t._v(" "+t._s(t._f("formatCurrency")(e.amounts.debit_amount))+" ")]),a("td",{staticClass:"text-warning"},[t._v(" "+t._s(t._f("formatCurrency")(e.amounts.loan_amount))+" ")]),a("td",{staticClass:"text-info"},[t._v(" "+t._s(t._f("formatCurrency")(e.amounts.total_amount))+" ")]),a("td",{staticClass:"text-center"},[a("Button",{staticClass:"btn-noborder",attrs:{color:"success",size:"sm"},on:{click:function(a){return t.approve(e)}}},[a("i",{staticClass:"si si-check mr-1"}),t._v(" Approve ")])],1)])}))],2):a("div",{staticClass:"min-height-300 d-flex flex-row justify-content-center align-items-center"},[a("h4",{staticClass:"text-gray-dark font-w300"},[t._v(" No transaction to approve ")])])])},u=[],d=(a("99af"),a("020b")),p=a("ad4f"),f={name:"ApprovalTable",components:{CardBase:d["a"],Button:p["a"]},props:{approvals:{type:Array,default:function(){return[]}}},methods:{approve:function(t){this.$emit("approve",{collectorId:t.id,collectorName:"".concat(t.first_name," ").concat(t.last_name)})}}},v=f,h=a("2877"),m=Object(h["a"])(v,l,u,!1,null,null,null),b=m.exports,_=a("c2cd"),g=a("78b5"),C={name:"Approval",components:{ContentHeader:c["a"],ApprovalTable:b,CardLoader:_["a"],Modal:g["a"]},data:function(){return{isFetchingData:!1,isApproveModalVisible:!1,targetCollection:{},isApproving:!1,approvals:[]}},created:function(){this.fetchData()},mounted:function(){var t=this;this.$bus.on("router-link-clicked",(function(){t.isFetchingData||t.fetchData()}))},methods:{fetchData:function(){var t=this;this.isFetchingData=!0,Object(i["b"])().then((function(e){var a=e.data;t.approvals=a})).catch((function(){t.$toast.error("There was an error while fetching data.")})).finally((function(){t.isFetchingData=!1}))},removeFromCollection:function(t,e){var a=Object(s["findIndex"])(this.approvals,["entry_date",t]),n=Object(s["findIndex"])(this.approvals[a].collections,["id",e]);this.approvals[a].collections.splice(n,1),0===this.approvals[a].collections.length&&this.approvals.splice(a,1)},onApproveCollection:function(t){this.targetCollection=t,this.isApproveModalVisible=!0},closeApproveModal:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isApproving&&!t||(this.isApproveModalVisible=!1)},approve:function(){var t=this,e=this.targetCollection.collectorId;this.isApproving=!0,Object(r["a"])(e).then((function(){t.$toast.success("Collection successfully approved"),t.fetchData(),t.closeApproveModal(!0)})).catch((function(e){t.$toast.error(e)})).finally((function(){t.isApproving=!1}))}}},y=C,x=Object(h["a"])(y,n,o,!1,null,null,null);e["default"]=x.exports},"1a1f":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"row mt-xl-n4 mb-4"},[a("div",{staticClass:"col-md-6"},[a("h5",{staticClass:"m-0 text-muted"},[t._t("default")],2)]),a("div",{staticClass:"col-md-6 text-right"},[t._t("extra")],2)])},o=[],s={name:"ContentHeader"},i=s,r=a("2877"),c=Object(r["a"])(i,n,o,!1,null,"adffe014",null);e["a"]=c.exports},"45b7":function(t,e,a){"use strict";var n=a("ed75"),o=a.n(n);o.a},"4ff9":function(t,e,a){},"5b67":function(t,e,a){"use strict";a.d(e,"a",(function(){return o}));var n=a("4360");function o(){var t=n["a"].getters.dateFilter;return"period"===t.type?{start_date:t.startDate||null,end_date:t.endDate||null,date_np:1}:{duration:t.type}}},"5c3e":function(t,e,a){"use strict";var n=a("a5d2"),o=a.n(n);o.a},"78b5":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("BackDrop",{staticClass:"d-flex justify-content-center align-items-center",attrs:{visible:t.visible},on:{close:t.onClose,closed:function(e){return t.$emit("closed")}}},[a("div",{staticClass:"custom-modal block custom-border-radius",class:{"pb-2":t.hideControls},style:t.modalWidth+"; "+t.modalMaxWidth+";"},[a("div",{staticClass:"block-header"},[a("h3",{staticClass:"block-title"},[t._v(" "+t._s(t.title)+" ")]),a("div",{staticClass:"block-options modal-close-btn mt-n2",on:{click:t.onClose}},[t._v(" Ã— ")])]),a("div",{staticClass:"px-4 py-2"},[t._t("default")],2),t.hideControls?t._e():a("div",{staticClass:"py-3 d-flex justify-content-end"},[t._t("footer",[a("Button",{staticClass:"mr-1",attrs:{color:"success",loading:t.loading},on:{click:function(e){return t.$emit("success")}}},[t._v(" OK ")]),a("Button",{staticClass:"ml-1",attrs:{color:"danger"},on:{click:t.onClose}},[t._v(" Close ")])])],2)])])},o=[],s=(a("a9e3"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.isBackdropShown?a("div",{staticClass:"backdrop",class:t.animationType},[t._t("default")],2):t._e()}),i=[],r={name:"BackDrop",props:{visible:{type:Boolean,default:!1},onClose:{type:Function,default:function(){}}},data:function(){return{animationType:"fade-in",isBackdropShown:!1}},watch:{visible:{handler:function(t){return t?this.showBackDrop():this.hideBackDrop()},immediate:!0}},methods:{showBackDrop:function(){this.animationType="fade-in",this.isBackdropShown=!0},hideBackDrop:function(){var t=this;this.animationType="fade-out",setTimeout((function(){t.isBackdropShown=!1,t.$emit("closed")}),150)}}},c=r,l=(a("5c3e"),a("2877")),u=Object(l["a"])(c,s,i,!1,null,"6c8f4972",null),d=u.exports,p=a("ad4f"),f={name:"Modal",components:{BackDrop:d,Button:p["a"]},props:{title:{type:String,default:"Title"},width:{type:[Number,String],default:null},maxWidth:{type:[Number,String],default:null},visible:{type:Boolean,default:!1},hideControls:{type:Boolean,default:!1},loading:{type:Boolean,default:!1}},computed:{modalWidth:function(){var t=this.width;return t?"width: ".concat(t,"vw;"):""},modalMaxWidth:function(){var t=this.maxWidth;return t?"max-width: ".concat(t,"vw;"):""}},methods:{onClose:function(){this.$emit("close")}}},v=f,h=(a("9dc3"),Object(l["a"])(v,n,o,!1,null,"01daf38d",null));e["a"]=h.exports},"7ede":function(t,e,a){"use strict";a.d(e,"d",(function(){return c})),a.d(e,"b",(function(){return l})),a.d(e,"a",(function(){return u})),a.d(e,"e",(function(){return d})),a.d(e,"c",(function(){return p}));var n=a("5530"),o=a("15fd"),s=a("9819"),i=a("5b67");function r(t){return t.start||t.end?{min_amount:t.start||0,max_amount:t.end||null}:{}}function c(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{amountRange:{}},e=t.collectorId,a=t.amountRange,c=Object(o["a"])(t,["collectorId","amountRange"]);return Object(s["a"])({url:"transactions",method:"get",cancelPrevious:!0,params:Object(n["a"])(Object(n["a"])(Object(n["a"])(Object(n["a"])({},c),Object(i["a"])()),r(a)),{},{collector_id:e})})}function l(t){return Object(s["a"])({url:"transactions",method:"post",data:t})}function u(t,e){return Object(s["a"])({url:"transactions/".concat(t,"/approve"),method:"patch",data:e})}function d(t){return Object(s["a"])({url:"transaction/import-amounts",method:"patch",data:t})}function p(t){return Object(s["a"])({url:"transactions/export",method:"post",data:t})}},"9dc3":function(t,e,a){"use strict";var n=a("4ff9"),o=a.n(n);o.a},a5d2:function(t,e,a){},c2cd:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{class:{"position-relative":t.isLoading}},[t._t("default"),t.isLoading?a("div",{staticClass:"custom-border-radius dropshadow",style:{background:"rgba(255, 255, 255, "+t.opacity+")"}},[a("div",{staticClass:"loader d-flex justify-content-center align-items-center"},[a("div",{style:{width:"40px"}},[a("Loader")],1)])]):t._e()],2)])},o=[],s=(a("a9e3"),a("9333")),i={name:"CardLoader",components:{Loader:s["a"]},props:{isLoading:{type:Boolean,default:!1},loadingMinHeight:{type:String,default:"0px"},opacity:{type:Number,default:1}}},r=i,c=(a("45b7"),a("2877")),l=Object(c["a"])(r,n,o,!1,null,"6ad3b29c",null);e["a"]=l.exports},ed75:function(t,e,a){},f4f7:function(t,e,a){"use strict";a.d(e,"a",(function(){return i})),a.d(e,"d",(function(){return r})),a.d(e,"e",(function(){return c})),a.d(e,"b",(function(){return l})),a.d(e,"c",(function(){return u}));var n=a("5530"),o=a("9819"),s=a("5b67");function i(){return Object(o["a"])({url:"aggregate/amounts",method:"get",params:Object(n["a"])({},Object(s["a"])()),cancelPrevious:!0})}function r(){return Object(o["a"])({url:"aggregate/collectors",method:"get",params:Object(n["a"])({per_page:7},Object(s["a"])()),cancelPrevious:!0})}function c(){return Object(o["a"])({url:"aggregate/customers",method:"get",params:Object(n["a"])({per_page:7},Object(s["a"])()),cancelPrevious:!0})}function l(){return Object(o["a"])({url:"aggregate/approvals",method:"get"})}function u(){return Object(o["a"])({url:"aggregate/billings",method:"get"})}}}]);