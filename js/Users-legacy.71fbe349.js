(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Users"],{"32f3":function(t,e,a){"use strict";var s=a("72ea"),n=a.n(s);n.a},4468:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("ContentHeader",[t._v(" Users ")]),a("UpdateUser",{attrs:{"user-id":t.targetUser.id,visible:t.isEditModalShown},on:{close:function(e){t.isEditModalShown=!1}}}),a("UserTable",{on:{edit:t.onEditUser}})],1)},n=[],i=a("1a1f"),r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"mb-4"},[a("UpdateStatus",{attrs:{visible:t.isStatusModalShown,user:t.targetUser,status:t.targetUser.status,submission:t.updateStatus},on:{success:t.setStatus,close:function(e){t.isStatusModalShown=!1}}}),a("CardBase",{staticClass:"p-4 mb-3"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-3"},[a("InputSelect",{attrs:{title:"Status","option-value":"value","option-text":"name",options:t.statuses},on:{select:function(e){return t.fetchData()}},model:{value:t.dataFilters.status,callback:function(e){t.$set(t.dataFilters,"status",e)},expression:"dataFilters.status"}})],1),a("div",{staticClass:"col-md-3"}),a("div",{staticClass:"col-md-6"},[a("Search",{staticClass:"mt-4 pt-1",attrs:{debounce:500},on:{change:function(e){return t.fetchData()}},model:{value:t.dataFilters.keyword,callback:function(e){t.$set(t.dataFilters,"keyword",e)},expression:"dataFilters.keyword"}})],1)])]),a("CardLoader",{attrs:{"is-loading":t.isLoading}},[a("CardBase",{staticClass:"table-responsive"},[t.users.length?a("table",{staticClass:"table table-vcenter m-0"},[a("thead",{staticClass:"bg-gray-lighter"},[a("tr",[a("th",{staticClass:"text-center"},[t._v(" # ")]),a("th",[t._v(" Photo ")]),a("th",{staticClass:"pl-4"},[t._v(" First Name ")]),a("th",[t._v("Last Name")]),a("th",[t._v("Email")]),a("th",[t._v("Last Online")]),a("th",{staticClass:"text-center"},[t._v(" Status ")]),a("th",{staticStyle:{width:"20%"}},[t._v(" Organization ")]),a("th",{staticStyle:{width:"130px"}})])]),a("tbody",t._l(t.users,(function(e,s){return a("tr",{key:e.id},[a("td",{staticClass:"text-center"},[t._v(" "+t._s(s+1)+" ")]),a("td",[a("ImageColumn",{attrs:{url:e.avatar_url}})],1),a("td",{staticClass:"pl-4 ml-4"},[t._v(" "+t._s(e.first_name)+" ")]),a("td",[t._v(t._s(e.last_name))]),a("td",[t._v(t._s(e.email))]),a("td",[a("LastOnlineCol",{attrs:{status:e.last_online}})],1),a("td",{staticClass:"text-center"},[a("StatusColumn",{attrs:{status:e.is_active},on:{change:function(a){return t.onStatusUpdate(e,a)}}})],1),a("td",[t._v(t._s(e.organization.name))]),a("td",[a("div",{staticClass:"d-flex flex-row justify-content-around"},[a("button",{staticClass:"btn btn-sm btn-success btn-noborder",attrs:{title:"edit"},on:{click:function(a){return t.$emit("edit",e)}}},[a("i",{staticClass:"si si-note"})])])])])})),0)]):a("div",{staticClass:"min-height-300 d-flex flex-row justify-content-center align-items-center"},[a("h4",{staticClass:"text-gray-dark font-w300"},[t._v(" No Data Found ")])])])],1),a("div",{staticClass:"d-flex justify-content-between align-items-center flex-wrap"},[a("div",[t._v(" "+t._s(t.pagination.message)+" ")]),a("div",{staticClass:"d-flex justify-content-center"},[a("InputSelect",{attrs:{options:[5,15,25,50,100]},on:{select:function(e){return t.fetchData()}},model:{value:t.pagination.perPage,callback:function(e){t.$set(t.pagination,"perPage",e)},expression:"pagination.perPage"}}),a("Pagination",{attrs:{length:t.pagination.pages,current:t.pagination.current},on:{change:t.changePagination}})],1)])],1)},o=[],l=a("5530"),u=a("2ef0"),c=a("ab74"),d=a("2612"),h=a("020b"),f=a("0af5"),p=a("0f8e"),m=a("9c4f"),v=a("9a1a"),b=a("c2cd"),g=a("66cb"),C=a("7e22"),_=a("31e6"),y={name:"UserTable",components:{Search:m["a"],ImageColumn:_["a"],Pagination:p["a"],InputSelect:f["a"],CardBase:h["a"],CardLoader:b["a"],StatusColumn:v["a"],LastOnlineCol:C["a"],UpdateStatus:g["a"]},data:function(){return{users:[],isLoading:!1,isStatusModalShown:!1,targetUser:{},statuses:[{name:"All",value:""},{name:"Active",value:1},{name:"Inactive",value:0}],dataFilters:{status:"",keyword:""},pagination:{pages:1,current:1,perPage:15}}},created:function(){this.$bus.on("reload-user-table",this.fetchData),this.fetchData()},beforeDestroy:function(){this.$bus.removeAllListeners("reload-user-table")},mounted:function(){var t=this;this.$bus.on("router-link-clicked",(function(){t.fetchData()}))},methods:{updateStatus:d["n"],setStatus:function(){var t=this.targetUser,e=Object(u["findIndex"])(this.users,["id",t.id]);this.users[e].is_active=t.status?1:0},onStatusUpdate:function(t,e){this.targetUser=Object(l["a"])(Object(l["a"])({},t),{},{status:e}),this.isStatusModalShown=!0},fetchData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=this.dataFilters,s=a.status,n=a.keyword;this.isLoading=!0,Object(d["e"])({page:e,is_active:s||null,keyword:n||null,per_page:this.pagination.perPage}).then((function(e){var a=e.data,s=e.meta;t.users=a,t.pagination=Object(c["f"])(s),t.isLoading=!1})).catch((function(e){"request-cancel"!==e&&(t.$toast.error("There was an error while fetching data."),t.isLoading=!1)}))},changePagination:function(t){this.pagination.current=t,this.fetchData(t)}}},w=y,S=a("2877"),P=Object(S["a"])(w,r,o,!1,null,null,null),x=P.exports,U=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Modal",{attrs:{title:"Edit User",visible:t.visible,"hide-controls":""},on:{close:t.close,closed:t.onClosed}},[a("CardLoader",{attrs:{"is-loading":t.isFetchingData}},[a("Tabs",{staticClass:"mt-n4",attrs:{current:t.activeTab,tabs:["General","Phone"]},on:{change:t.changeTab}},[a("div",{staticClass:"pt-4"},[t.isTabActive("General")?a("User",{staticClass:"fade-in",attrs:{loading:t.isSubmitting,"edit-mode":""},on:{submit:t.updateUser},model:{value:t.user,callback:function(e){t.user=e},expression:"user"}}):t.isTabActive("Phone")?a("Phone",{staticClass:"fade-in",attrs:{"user-id":t.user.id},model:{value:t.user.phones,callback:function(e){t.$set(t.user,"phones",e)},expression:"user.phones"}}):t._e()],1)])],1)],1)},$=[],k=(a("a9e3"),a("d3b7"),a("78b5")),j=a("fa43"),O=a("47a4"),D=a("71f7"),T=a("a1be"),E={name:"UpdateUser",components:{Modal:k["a"],Tabs:j["a"],User:O["a"],Phone:D["a"],CardLoader:b["a"]},props:{visible:{type:Boolean,default:!1},userId:{type:Number,default:null}},data:function(){return{activeTab:"",isFetchingData:!1,isSubmitting:!1,user:{}}},watch:{visible:function(t){t&&this.fetchData()}},methods:{fetchData:function(){var t=this;this.isFetchingData=!0,Object(d["c"])(this.userId).then((function(e){t.user=Object(T["d"])(e),t.activeTab="General"})).catch((function(){t.close(),t.$toast.error("There was an error while fetching user data!")})).finally((function(){t.isFetchingData=!1}))},updateUser:function(){var t=this;this.isSubmitting=!0,Object(d["o"])(this.userId,this.user).then((function(){t.$toast.success("User successfully updated"),t.$bus.emit("reload-user-table")})).catch((function(e){t.$toast.error(e,{duration:1e4})})).finally((function(){t.isSubmitting=!1}))},isTabActive:function(t){return this.activeTab===t},close:function(){this.isSubmitting||this.$emit("close")},onClosed:function(){this.activeTab=""},changeTab:function(t){this.isSubmitting||(this.activeTab=t)}}},F=E,L=Object(S["a"])(F,U,$,!1,null,null,null),I=L.exports,A={name:"Index",components:{ContentHeader:i["a"],UserTable:x,UpdateUser:I},data:function(){return{targetUser:{},isEditModalShown:!1}},methods:{onEditUser:function(t){this.targetUser=t,this.isEditModalShown=!0}}},M=A,N=Object(S["a"])(M,s,n,!1,null,null,null);e["default"]=N.exports},"66cb":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Modal",{attrs:{title:"Confirmation",visible:t.visible,loading:t.loading},on:{success:t.onSuccess,close:t.close}},[t._v(" Are you sure you want to "+t._s(t.state)+" "+t._s(t.userName)+"? ")])},n=[],i=(a("99af"),a("d3b7"),a("78b5")),r={name:"UpdateStatus",components:{Modal:i["a"]},props:{visible:{type:Boolean,default:!1},user:{type:Object,default:function(){return{}}},status:{type:Boolean,default:!1},submission:{type:Function,default:function(){}}},data:function(){return{loading:!1}},computed:{state:function(){return this.status?"activate":"deactivate"},userName:function(){return"".concat(this.user.first_name," ").concat(this.user.last_name)}},methods:{onSuccess:function(){var t=this;this.loading=!0,this.submission(this.user.id,this.status).then((function(){t.$toast.success("Status successfully updated"),t.$emit("success"),t.close(!0)})).catch((function(){t.$toast.error("There was an error while changing status")})).finally((function(){t.loading=!1}))},close:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.loading&&!t||this.$emit("close")}}},o=r,l=a("2877"),u=Object(l["a"])(o,s,n,!1,null,null,null);e["a"]=u.exports},"71f7":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("form",{on:{submit:function(e){return e.preventDefault(),t.formSubmit(e)}}},[a("ForeShadow",{attrs:{visible:t.loading}},[a("SimpleBar",{staticClass:"modal-form-wrapper"},[a("div",{staticClass:"row"},t._l(t.inputPhones,(function(e,s){return a("div",{key:s,staticClass:"col-12 phone-wrapper"},[a("div",{staticClass:"form-group"},[a("div",{staticClass:"d-flex align-items-center flex-wrap"},[a("div",{staticClass:"flex-grow-1 mr-4"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.phone,expression:"phone.phone"}],staticClass:"form-control flex-grow-1",class:{"is-primary":e.isPrimary,"is-invalid":e.error},attrs:{placeholder:"Phone",type:"text",required:"",pattern:"\\+?(?:[0-9]{3})?(?:\\s|-)?[0-9]{6,10}"},domProps:{value:e.phone},on:{input:[function(a){a.target.composing||t.$set(e,"phone",a.target.value)},function(e){return t.removeError(s)}]}}),e.error?a("span",{staticClass:"text-danger"},[t._v(" "+t._s(e.error)+" ")]):t._e()]),a("div",{staticClass:"d-flex"},[a("a",{staticClass:"enable-underline mr-3 text-nowrap",class:{"disabled-link":e.isPrimary},attrs:{tabindex:"-1",href:"#"},on:{click:function(e){return e.preventDefault(),t.setAsPrimary(s)}}},[t._v("set as primary ")]),a("a",{staticClass:"enable-underline text-danger",class:{"disabled-link":e.isPrimary},attrs:{tabindex:"-1",href:"#"},on:{click:function(e){return e.preventDefault(),t.removePhone(s)}}},[t._v("remove")])])])])])})),0),a("div",{staticClass:"row"},[a("div",{staticClass:"col-12"},[a("a",{staticClass:"enable-underline",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.addNewPhone(e)}}},[t._v(" Add New ")])])])]),a("div",{staticClass:"py-3 d-flex justify-content-start"},[a("Button",{attrs:{type:"submit",loading:t.loading,disabled:t.loading,color:"primary"}},[t._v(" Update ")])],1)],1)],1)])},n=[],i=(a("4de4"),a("d81d"),a("a434"),a("a9e3"),a("d3b7"),a("25f0"),a("8d3b")),r=a("2ef0"),o=a("2612"),l=a("ad4f"),u=a("d855"),c={name:"Phone",components:{Button:l["a"],ForeShadow:u["a"],SimpleBar:i["a"]},props:{userId:{type:Number,default:null},value:{type:Array,default:function(){return[]}}},data:function(){return{loading:!1,inputPhones:[]}},watch:{value:{handler:function(t){this.inputPhones=t.map((function(t){return{phone:t.phone,isPrimary:!!t.is_primary,error:""}}))},immediate:!0}},methods:{addNewPhone:function(){this.inputPhones.push({phone:"",isPrimary:!1,error:""})},setAsPrimary:function(t){if(this.inputPhones[t].phone){var e=Object(r["findIndex"])(this.inputPhones,"isPrimary");this.inputPhones[e]&&(this.inputPhones[e].isPrimary=!1),this.inputPhones[t].isPrimary=!0}else this.inputPhones[t].error="Cannot set empty value as primary."},formSubmit:function(){var t=this,e=this.inputPhones.filter((function(t){return!!t.phone})).map((function(t){return{phone:t.phone.toString(),is_primary:t.isPrimary?1:0}}));this.loading=!0,Object(o["l"])(this.userId,{phones:e}).then((function(){t.$emit("input",e),t.$emit("updated",e),t.$toast.success("Phone successfully updated")})).catch((function(e){t.$toast.error(e,{duration:1e4})})).finally((function(){t.loading=!1}))},removePhone:function(t){this.inputPhones.splice(t,1)},removeError:function(t){this.inputPhones[t].error=""}}},d=c,h=(a("32f3"),a("2877")),f=Object(h["a"])(d,s,n,!1,null,"01f75095",null);e["a"]=f.exports},"72ea":function(t,e,a){},"7e22":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{class:{"font-italic text-gray-dark":""===t.status}},[t._v(" "+t._s(t.status||"N/A")+" ")])},n=[],i={name:"LastOnlineColumn",props:{status:{type:String,default:""}}},r=i,o=a("2877"),l=Object(o["a"])(r,s,n,!1,null,null,null);e["a"]=l.exports},fa43:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"block mb-0"},[a("ul",{staticClass:"nav nav-tabs nav-tabs-alt",attrs:{"data-toggle":"tabs",role:"tablist"}},t._l(t.tabs,(function(e,s){return a("li",{key:s,staticClass:"nav-item"},[a("a",{staticClass:"nav-link text-capitalize",class:{active:t.current===e},attrs:{href:"#"},on:{click:function(a){return a.preventDefault(),t.$emit("change",e)}}},[t._v(t._s(e))])])})),0),a("div",{staticClass:"tab-content"},[t._t("default")],2)])},n=[],i={props:{current:{type:String,default:""},tabs:{type:Array,default:function(){return[]}}}},r=i,o=a("2877"),l=Object(o["a"])(r,s,n,!1,null,null,null);e["a"]=l.exports}}]);