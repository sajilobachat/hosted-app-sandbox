(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["accountants"],{"00c4":function(t,a,e){"use strict";var s=e("9d35"),n=e.n(s);n.a},"32f3":function(t,a,e){"use strict";var s=e("72ea"),n=e.n(s);n.a},"66cb":function(t,a,e){"use strict";var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("Modal",{attrs:{title:"Confirmation",visible:t.visible,loading:t.loading},on:{success:t.onSuccess,close:t.close}},[t._v(" Are you sure you want to "+t._s(t.state)+" "+t._s(t.userName)+"? ")])},n=[],i=e("78b5"),o={name:"UpdateStatus",components:{Modal:i["a"]},props:{visible:{type:Boolean,default:!1},user:{type:Object,default:()=>({})},status:{type:Boolean,default:!1},submission:{type:Function,default:()=>{}}},data(){return{loading:!1}},computed:{state(){return this.status?"activate":"deactivate"},userName(){return`${this.user.first_name} ${this.user.last_name}`}},methods:{onSuccess(){this.loading=!0,this.submission(this.user.id,this.status).then(()=>{this.$toast.success("Status successfully updated"),this.$emit("success"),this.close(!0)}).catch(()=>{this.$toast.error("There was an error while changing status")}).finally(()=>{this.loading=!1})},close(t=!1){this.loading&&!t||this.$emit("close")}}},c=o,r=e("2877"),l=Object(r["a"])(c,s,n,!1,null,null,null);a["a"]=l.exports},"6d04":function(t,a,e){"use strict";var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("form",{on:{submit:function(a){return a.preventDefault(),t.formSubmit(a)}}},[e("ForeShadow",{attrs:{visible:t.isSubmitting}},[e("SimpleBar",{staticClass:"modal-form-wrapper"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-9"},[e("InputText",{attrs:{title:"New Password",type:"password",error:t.error,required:""},on:{input:function(a){t.error=""}},model:{value:t.newPassword,callback:function(a){t.newPassword=a},expression:"newPassword"}})],1),e("div",{staticClass:"col-9"},[e("InputText",{attrs:{title:"Confirm Password",error:t.error,type:"password",required:""},on:{input:function(a){t.error=""}},model:{value:t.confirmPassword,callback:function(a){t.confirmPassword=a},expression:"confirmPassword"}})],1)])])],1),e("div",{staticClass:"py-3 d-flex justify-content-start"},[e("Button",{attrs:{type:"submit",loading:t.isSubmitting,color:"primary"}},[t._v(" Update ")])],1)],1)},n=[],i=e("8d3b"),o=e("2612"),c=e("7fb4"),r=e("ad4f"),l=e("d855"),u={name:"SecurityForm",components:{InputText:c["a"],Button:r["a"],ForeShadow:l["a"],SimpleBar:i["a"]},props:{user:{type:Object,default:()=>({})}},data(){return{newPassword:"",confirmPassword:"",error:"",isSubmitting:!1}},methods:{formSubmit(){this.newPassword===this.confirmPassword?(this.isSubmitting=!0,Object(o["h"])({token:this.user.token,new_password:this.newPassword}).then(()=>{this.$toast.success("Password successfully updated.")}).catch(t=>{this.$toast.error(t,{duration:1e4})}).finally(()=>{this.isSubmitting=!1})):this.error="Password didn't match"}}},d=u,h=e("2877"),p=Object(h["a"])(d,s,n,!1,null,null,null);a["a"]=p.exports},"71f7":function(t,a,e){"use strict";var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("form",{on:{submit:function(a){return a.preventDefault(),t.formSubmit(a)}}},[e("ForeShadow",{attrs:{visible:t.loading}},[e("SimpleBar",{staticClass:"modal-form-wrapper"},[e("div",{staticClass:"row"},t._l(t.inputPhones,(function(a,s){return e("div",{key:s,staticClass:"col-12 phone-wrapper"},[e("div",{staticClass:"form-group"},[e("div",{staticClass:"d-flex align-items-center flex-wrap"},[e("div",{staticClass:"flex-grow-1 mr-4"},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.phone,expression:"phone.phone"}],staticClass:"form-control flex-grow-1",class:{"is-primary":a.isPrimary,"is-invalid":a.error},attrs:{placeholder:"Phone",type:"text",required:"",pattern:"\\+?(?:[0-9]{3})?(?:\\s|-)?[0-9]{6,10}"},domProps:{value:a.phone},on:{input:[function(e){e.target.composing||t.$set(a,"phone",e.target.value)},function(a){return t.removeError(s)}]}}),a.error?e("span",{staticClass:"text-danger"},[t._v(" "+t._s(a.error)+" ")]):t._e()]),e("div",{staticClass:"d-flex"},[e("a",{staticClass:"enable-underline mr-3 text-nowrap",class:{"disabled-link":a.isPrimary},attrs:{tabindex:"-1",href:"#"},on:{click:function(a){return a.preventDefault(),t.setAsPrimary(s)}}},[t._v("set as primary ")]),e("a",{staticClass:"enable-underline text-danger",class:{"disabled-link":a.isPrimary},attrs:{tabindex:"-1",href:"#"},on:{click:function(a){return a.preventDefault(),t.removePhone(s)}}},[t._v("remove")])])])])])})),0),e("div",{staticClass:"row"},[e("div",{staticClass:"col-12"},[e("a",{staticClass:"enable-underline",attrs:{href:"#"},on:{click:function(a){return a.preventDefault(),t.addNewPhone(a)}}},[t._v(" Add New ")])])])]),e("div",{staticClass:"py-3 d-flex justify-content-start"},[e("Button",{attrs:{type:"submit",loading:t.loading,disabled:t.loading,color:"primary"}},[t._v(" Update ")])],1)],1)],1)])},n=[],i=(e("25f0"),e("8d3b")),o=e("2ef0"),c=e("2612"),r=e("ad4f"),l=e("d855"),u={name:"Phone",components:{Button:r["a"],ForeShadow:l["a"],SimpleBar:i["a"]},props:{userId:{type:Number,default:null},value:{type:Array,default:()=>[]}},data(){return{loading:!1,inputPhones:[]}},watch:{value:{handler(t){this.inputPhones=t.map(t=>({phone:t.phone,isPrimary:!!t.is_primary,error:""}))},immediate:!0}},methods:{addNewPhone(){this.inputPhones.push({phone:"",isPrimary:!1,error:""})},setAsPrimary(t){if(!this.inputPhones[t].phone)return void(this.inputPhones[t].error="Cannot set empty value as primary.");const a=Object(o["findIndex"])(this.inputPhones,"isPrimary");this.inputPhones[a]&&(this.inputPhones[a].isPrimary=!1),this.inputPhones[t].isPrimary=!0},formSubmit(){const t=this.inputPhones.filter(t=>!!t.phone).map(t=>({phone:t.phone.toString(),is_primary:t.isPrimary?1:0}));this.loading=!0,Object(c["l"])(this.userId,{phones:t}).then(()=>{this.$emit("input",t),this.$emit("updated",t),this.$toast.success("Phone successfully updated")}).catch(t=>{this.$toast.error(t,{duration:1e4})}).finally(()=>{this.loading=!1})},removePhone(t){this.inputPhones.splice(t,1)},removeError(t){this.inputPhones[t].error=""}}},d=u,h=(e("32f3"),e("2877")),p=Object(h["a"])(d,s,n,!1,null,"01f75095",null);a["a"]=p.exports},"72ea":function(t,a,e){},"7e22":function(t,a,e){"use strict";var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("span",{class:{"font-italic text-gray-dark":""===t.status}},[t._v(" "+t._s(t.status||"N/A")+" ")])},n=[],i={name:"LastOnlineColumn",props:{status:{type:String,default:""}}},o=i,c=e("2877"),r=Object(c["a"])(o,s,n,!1,null,null,null);a["a"]=r.exports},"9d35":function(t,a,e){},a664:function(t,a,e){"use strict";e.r(a);var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("ContentHeader",[t._v(" Accountant "),e("template",{slot:"extra"},[e("button",{staticClass:"btn btn-primary ml-2 btn-noborder",on:{click:function(a){t.isCreateFormShown=!0}}},[t._v(" Add Accountant ")])])],2),e("AccountantTable",{on:{delete:t.onDeleteAccountant,edit:t.onEditAccountant}}),e("DeleteAccountant",{attrs:{visible:t.isDeleteModalShown,accountant:t.targetAccountant},on:{close:function(a){t.isDeleteModalShown=!1}}}),e("CreateAccountantForm",{attrs:{visible:t.isCreateFormShown},on:{close:function(a){t.isCreateFormShown=!1}}}),e("UpdateAccountant",{attrs:{"accountant-id":t.targetAccountant.id,visible:t.isEditModalShown},on:{close:function(a){t.isEditModalShown=!1}}})],1)},n=[],i=e("1a1f"),o=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"mb-4"},[e("UpdateStatus",{attrs:{visible:t.isStatusModalShown,user:t.targetAccountant,status:t.targetAccountant.status,submission:t.updateStatus},on:{success:t.setStatus,close:function(a){t.isStatusModalShown=!1}}}),e("CardBase",{staticClass:"p-4 mb-3"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-3"},[e("InputSelect",{attrs:{title:"Status","option-value":"value","option-text":"name",options:t.statuses},on:{select:function(a){return t.fetchData()}},model:{value:t.dataFilters.status,callback:function(a){t.$set(t.dataFilters,"status",a)},expression:"dataFilters.status"}})],1),e("div",{staticClass:"col-md-3"}),e("div",{staticClass:"col-md-6"},[e("Search",{staticClass:"mt-4 pt-1",attrs:{debounce:500},on:{change:function(a){return t.fetchData()}},model:{value:t.dataFilters.keyword,callback:function(a){t.$set(t.dataFilters,"keyword",a)},expression:"dataFilters.keyword"}})],1)])]),e("CardLoader",{attrs:{"is-loading":t.isLoading}},[e("CardBase",{staticClass:"table-responsive"},[t.accountants.length?e("table",{staticClass:"table table-vcenter m-0"},[e("thead",{staticClass:"bg-gray-lighter"},[e("tr",[e("th",{staticClass:"text-center"},[t._v(" # ")]),e("th",[t._v(" Photo ")]),e("th",{staticClass:"pl-4"},[t._v(" Full Name ")]),e("th",[t._v("Phone")]),e("th",[t._v("Last Online")]),e("th",{staticClass:"text-center"},[t._v(" Status ")]),e("th",{staticStyle:{width:"130px"}})])]),e("tbody",t._l(t.accountants,(function(a,s){return e("tr",{key:a.id},[e("td",{staticClass:"text-center"},[t._v(" "+t._s(s+1)+" ")]),e("td",[e("ImageColumn",{attrs:{url:a.avatar_url}})],1),e("td",{staticClass:"pl-4 ml-4"},[t._v(" "+t._s(a.fullname||a.first_name+" "+a.last_name)+" ")]),e("td",[t._v(" "+t._s(a.phone||"N/a")+" ")]),e("td",[e("LastOnlineCol",{attrs:{status:a.last_online}})],1),e("td",{staticClass:"text-center"},[e("StatusColumn",{attrs:{status:a.is_active},on:{change:function(e){return t.onStatusUpdate(a,e)}}})],1),e("td",[e("div",{staticClass:"d-flex flex-row justify-content-around"},[e("button",{staticClass:"btn btn-sm btn-success btn-noborder",on:{click:function(e){return t.$emit("edit",a)}}},[e("i",{staticClass:"si si-note"})])])])])})),0)]):e("div",{staticClass:"min-height-300 d-flex flex-row justify-content-center align-items-center"},[e("h4",{staticClass:"text-gray-dark font-w300"},[t._v(" No Data Found ")])])])],1),e("div",{staticClass:"d-flex justify-content-between align-items-center flex-wrap"},[e("div",[t._v(" "+t._s(t.pagination.message)+" ")]),e("div",{staticClass:"d-flex justify-content-center"},[e("InputSelect",{attrs:{options:[5,15,25,50,100]},on:{select:function(a){return t.fetchData()}},model:{value:t.pagination.perPage,callback:function(a){t.$set(t.pagination,"perPage",a)},expression:"pagination.perPage"}}),e("Pagination",{attrs:{length:t.pagination.pages,current:t.pagination.current},on:{change:t.changePagination}})],1)])],1)},c=[],r=e("15fd"),l=e("5530"),u=e("2ef0"),d=e("9819");function h(t){return Object(d["a"])({url:"accountants",method:"get",params:t,cancelPrevious:!0})}function p(t){return Object(d["a"])({url:"accountants/"+t,method:"get"})}function m(t){return Object(d["a"])({url:"accountants",method:"post",data:t})}function f(t,a){return Object(d["a"])({url:"accountants/"+t,method:"patch",data:a})}function b(t){return Object(d["a"])({url:"accountants/"+t,method:"delete"})}function v(t,a){return Object(d["a"])({url:`accountants/${t}/status`,method:"patch",data:{is_active:a?1:0}})}var g=e("ab74"),w=e("020b"),C=e("9c4f"),y=e("31e6"),_=e("66cb"),S=e("0af5"),P=e("9a1a"),A=e("0f8e"),x=e("c2cd"),$=e("7e22"),j={name:"AccountantTable",components:{Search:C["a"],InputSelect:S["a"],CardBase:w["a"],Pagination:A["a"],CardLoader:x["a"],ImageColumn:y["a"],StatusColumn:P["a"],LastOnlineCol:$["a"],UpdateStatus:_["a"]},data(){return{accountants:[],isLoading:!1,targetAccountant:{},isStatusModalShown:!1,statuses:[{name:"All",value:null},{name:"Active",value:1},{name:"Inactive",value:0}],dataFilters:{status:1,keyword:""},pagination:{pages:1,current:1,perPage:15}}},created(){this.$bus.on("reload-accountant-table",this.fetchData),this.fetchData()},beforeDestroy(){this.$bus.removeAllListeners("reload-accountant-table")},mounted(){this.$bus.on("router-link-clicked",()=>{this.isLoading||this.fetchData()})},methods:{updateStatus:v,setStatus(){const t=this.targetAccountant,a=Object(u["findIndex"])(this.accountants,["id",t.id]);this.accountants[a].is_active=t.status?1:0},onStatusUpdate(t,a){this.targetAccountant=Object(l["a"])(Object(l["a"])({},t),{},{status:a}),this.isStatusModalShown=!0},fetchData(t){const{status:a,keyword:e}=this.dataFilters;this.isLoading=!0,h({is_active:a||null,keyword:e||null,page:t||null,per_page:this.pagination.perPage}).then(({data:t,meta:a})=>{this.accountants=t.map(t=>{let{phones:a}=t,e=Object(r["a"])(t,["phones"]);return Object(l["a"])(Object(l["a"])({},e),{},{phone:Object(g["g"])(a)})}),this.pagination=Object(g["f"])(a),this.isLoading=!1}).catch(t=>{"request-cancel"!==t&&(this.$toast.error("There was an error while fetching data."),this.isLoading=!1)})},changePagination(t){this.pagination.current=t,this.fetchData(t)}}},O=j,k=e("2877"),D=Object(k["a"])(O,o,c,!1,null,null,null),F=D.exports,L=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("Modal",{attrs:{title:"Create Accountant",visible:t.visible,"hide-controls":""},on:{closed:t.reset,close:t.close}},[e("User",{staticClass:"fade-in",attrs:{loading:t.isLoading},on:{submit:t.createAccountant},model:{value:t.accountant,callback:function(a){t.accountant=a},expression:"accountant"}})],1)},T=[],M=e("78b5"),E=e("47a4"),B={name:"CreateAccountantForm",components:{Modal:M["a"],User:E["a"]},props:{visible:{type:Boolean,default:!1}},data(){return{accountant:{},isLoading:!1,isUserFormShown:!0}},methods:{createAccountant(){this.isLoading=!0;const{accountant:t}=this,{first_name:a,last_name:e}=t;m(Object(l["a"])(Object(l["a"])({},t),{},{fullname:`${a} ${e}`})).then(()=>{this.$bus.emit("reload-accountant-table"),this.$toast.success("Accountant Successfully Created")}).catch(t=>{this.$toast.error(t)}).finally(()=>{this.isLoading=!1,this.close()})},close(){this.isLoading||this.$emit("close")},reset(){this.accountant={},this.isLoading=!1,this.isUserFormShown=!0}}},I=B,U=(e("00c4"),Object(k["a"])(I,L,T,!1,null,"62ca799c",null)),N=U.exports,q=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("Modal",{attrs:{title:"Edit Accountant",visible:t.visible,"hide-controls":""},on:{close:t.close,closed:t.onClosed}},[e("CardLoader",{attrs:{"is-loading":t.isFetchingData}},[e("Tabs",{staticClass:"mt-n4",attrs:{current:t.activeTab,tabs:["General","Phone","Security"]},on:{change:t.changeTab}},[e("div",{staticClass:"pt-4"},[t.isTabActive("General")?e("User",{staticClass:"fade-in",attrs:{loading:t.isSubmitting,"edit-mode":""},on:{submit:t.updateAccountant},model:{value:t.accountant,callback:function(a){t.accountant=a},expression:"accountant"}}):t.isTabActive("Phone")?e("Phone",{staticClass:"fade-in",attrs:{"user-id":t.accountant.user_id},on:{updated:t.reloadTable},model:{value:t.accountant.phones,callback:function(a){t.$set(t.accountant,"phones",a)},expression:"accountant.phones"}}):t.isTabActive("Security")?e("Security",{staticClass:"fade-in",attrs:{user:{id:t.accountant.user_id,token:t.accountant.token}}}):t._e()],1)])],1)],1)},G=[],H=e("fa43"),J=e("71f7"),z=e("6d04"),K=e("a1be"),Q={name:"UpdateAccountant",components:{Modal:M["a"],Tabs:H["a"],User:E["a"],Phone:J["a"],Security:z["a"],CardLoader:x["a"]},props:{visible:{type:Boolean,default:!1},accountantId:{type:Number,default:null}},data(){return{activeTab:"General",isFetchingData:!1,isSubmitting:!1,accountant:{}}},watch:{visible(t){t&&this.fetchData()}},methods:{fetchData(){this.isFetchingData=!0,p(this.accountantId).then(t=>{this.accountant=Object(K["d"])(t),this.activeTab="General"}).catch(()=>{this.close(),this.$toast.error("There was an error while fetching accountant data!")}).finally(()=>{this.isFetchingData=!1})},updateAccountant(){this.isSubmitting=!0;const{accountant:t}=this,{first_name:a,last_name:e}=t;f(this.accountantId,Object(l["a"])(Object(l["a"])({},t),{},{fullname:`${a} ${e}`})).then(()=>{this.$toast.success("Accountant successfully updated"),this.$bus.emit("reload-accountant-table")}).catch(t=>{this.$toast.error(t)}).finally(()=>{this.isSubmitting=!1})},close(){this.isSubmitting||this.$emit("close")},onClosed(){this.activeTab=""},isTabActive(t){return this.activeTab===t},changeTab(t){this.isSubmitting||(this.activeTab=t)},reloadTable(){this.$bus.emit("reload-accountant-table")}}},R=Q,V=Object(k["a"])(R,q,G,!1,null,null,null),W=V.exports,X=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("Modal",{attrs:{title:"Delete Accountant",visible:t.visible,loading:t.isLoading},on:{close:t.onClose,success:t.deleteAccountant}},[t._v(" Are you sure you want to delete "+t._s(t.accountant.first_name+" "+t.accountant.last_name)+"? ")])},Y=[],Z={name:"DeleteAccountant",components:{Modal:M["a"]},props:{visible:{type:Boolean,default:!1},accountant:{type:Object,default:()=>({})}},data(){return{isLoading:!1}},methods:{deleteAccountant(){this.isLoading=!0,b(this.accountant.id).then(()=>{this.$bus.emit("reload-accountant-table"),this.$toast.success("Successfully Deleted!")}).catch(t=>{const a=t||"There was an error while deleting accountant!";this.$toast.error(a)}).finally(()=>{this.isLoading=!1,this.onClose()})},onClose(){this.isLoading||this.$emit("close")}}},tt=Z,at=Object(k["a"])(tt,X,Y,!1,null,null,null),et=at.exports,st={name:"Accountants",components:{CreateAccountantForm:N,AccountantTable:F,ContentHeader:i["a"],UpdateAccountant:W,DeleteAccountant:et},data(){return{isCreateFormShown:!1,isDeleteModalShown:!1,isStatusModalShown:!1,isEditModalShown:!1,targetAccountant:{}}},methods:{onDeleteAccountant(t){this.targetAccountant=t,this.isDeleteModalShown=!0},onEditAccountant(t){this.targetAccountant=t,this.isEditModalShown=!0}}},nt=st,it=Object(k["a"])(nt,s,n,!1,null,null,null);a["default"]=it.exports},fa43:function(t,a,e){"use strict";var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"block mb-0"},[e("ul",{staticClass:"nav nav-tabs nav-tabs-alt",attrs:{"data-toggle":"tabs",role:"tablist"}},t._l(t.tabs,(function(a,s){return e("li",{key:s,staticClass:"nav-item"},[e("a",{staticClass:"nav-link text-capitalize",class:{active:t.current===a},attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.$emit("change",a)}}},[t._v(t._s(a))])])})),0),e("div",{staticClass:"tab-content"},[t._t("default")],2)])},n=[],i={props:{current:{type:String,default:""},tabs:{type:Array,default:()=>[]}}},o=i,c=e("2877"),r=Object(c["a"])(o,s,n,!1,null,null,null);a["a"]=r.exports}}]);