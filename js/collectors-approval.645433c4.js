(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["collectors-approval"],{"020b":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"block custom-border-radius custom-box-shadow"},[t._t("default")],2)},o=[],n={name:"CardBase"},r=n,i=a("2877"),c=Object(i["a"])(r,s,o,!1,null,"6a27c542",null);e["a"]=c.exports},"103f":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("ContentHeader",[t._v(" Approvals ")]),a("Modal",{attrs:{visible:t.isApproveModalVisible,loading:t.isApproving,title:"Confirmation"},on:{success:t.approve,close:t.closeApproveModal}},[t._v(" Are you sure you want to approve collection by "+t._s(t.targetCollection.collectorName)+"? ")]),a("CardLoader",{attrs:{"is-loading":t.isFetchingData}},[a("ApprovalTable",{attrs:{approvals:t.approvals},on:{approve:t.onApproveCollection}})],1)],1)},o=[],n=a("2ef0"),r=a("f4f7"),i=a("7ede"),c=a("1a1f"),l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("CardBase",{staticClass:"mb-4 px-4 pb-3",staticStyle:{"padding-top":"30px"}},[t.approvals.length?a("table",{staticClass:"table table-vcenter m-0 table-borderless"},[a("thead",{staticClass:"bg-gray-lighter"},[a("tr",[a("th",{staticClass:"text-center"},[t._v(" # ")]),a("th",{staticStyle:{width:"20%"}},[t._v(" Collector ")]),a("th",[t._v(" From ")]),a("th",[t._v(" To ")]),a("th",[t._v(" Deposit ")]),a("th",[t._v(" Withdraw ")]),a("th",[t._v(" Loan ")]),a("th",[t._v(" Total ")]),a("th",{staticClass:"text-center",staticStyle:{width:"110px"}})])]),t._l(t.approvals,(function(e,s){return a("tr",{key:e.id},[a("td",{staticClass:"text-center"},[t._v(" "+t._s(s+1)+" ")]),a("td",[t._v(" "+t._s(e.first_name+" "+e.last_name)+" ")]),a("td",[e.start_date?a("span",[t._v(" "+t._s(e.start_date)+" ")]):a("span",{staticClass:"font-italic text-gray"},[t._v(" N/A ")])]),a("td",[e.end_date?a("span",[t._v(" "+t._s(e.end_date)+" ")]):a("span",{staticClass:"font-italic text-gray"},[t._v(" N/A ")])]),a("td",{staticClass:"text-success"},[t._v(" "+t._s(t._f("formatCurrency")(e.amounts.credit_amount))+" ")]),a("td",{staticClass:"text-danger"},[t._v(" "+t._s(t._f("formatCurrency")(e.amounts.debit_amount))+" ")]),a("td",{staticClass:"text-warning"},[t._v(" "+t._s(t._f("formatCurrency")(e.amounts.loan_amount))+" ")]),a("td",{staticClass:"text-info"},[t._v(" "+t._s(t._f("formatCurrency")(e.amounts.total_amount))+" ")]),a("td",{staticClass:"text-center"},[a("Button",{staticClass:"btn-noborder",attrs:{color:"success",size:"sm"},on:{click:function(a){return t.approve(e)}}},[a("i",{staticClass:"si si-check mr-1"}),t._v(" Approve ")])],1)])}))],2):a("div",{staticClass:"min-height-300 d-flex flex-row justify-content-center align-items-center"},[a("h4",{staticClass:"text-gray-dark font-w300"},[t._v(" No transaction to approve ")])])])},d=[],u=a("020b"),p=a("ad4f"),f={name:"ApprovalTable",components:{CardBase:u["a"],Button:p["a"]},props:{approvals:{type:Array,default:()=>[]}},methods:{approve(t){this.$emit("approve",{collectorId:t.id,collectorName:`${t.first_name} ${t.last_name}`})}}},h=f,v=a("2877"),m=Object(v["a"])(h,l,d,!1,null,null,null),b=m.exports,_=a("c2cd"),g=a("78b5"),C={name:"Approval",components:{ContentHeader:c["a"],ApprovalTable:b,CardLoader:_["a"],Modal:g["a"]},data(){return{isFetchingData:!1,isApproveModalVisible:!1,targetCollection:{},isApproving:!1,approvals:[]}},created(){this.fetchData()},mounted(){this.$bus.on("router-link-clicked",()=>{this.isFetchingData||this.fetchData()})},methods:{fetchData(){this.isFetchingData=!0,Object(r["b"])().then(({data:t})=>{this.approvals=t}).catch(()=>{this.$toast.error("There was an error while fetching data.")}).finally(()=>{this.isFetchingData=!1})},removeFromCollection(t,e){const a=Object(n["findIndex"])(this.approvals,["entry_date",t]),s=Object(n["findIndex"])(this.approvals[a].collections,["id",e]);this.approvals[a].collections.splice(s,1),0===this.approvals[a].collections.length&&this.approvals.splice(a,1)},onApproveCollection(t){this.targetCollection=t,this.isApproveModalVisible=!0},closeApproveModal(t=!1){this.isApproving&&!t||(this.isApproveModalVisible=!1)},approve(){const{collectorId:t}=this.targetCollection;this.isApproving=!0,Object(i["a"])(t).then(()=>{this.$toast.success("Collection successfully approved"),this.fetchData(),this.closeApproveModal(!0)}).catch(t=>{this.$toast.error(t)}).finally(()=>{this.isApproving=!1})}}},y=C,x=Object(v["a"])(y,s,o,!1,null,null,null);e["default"]=x.exports},"1a1f":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"row mt-xl-n4 mb-4"},[a("div",{staticClass:"col-md-6"},[a("h5",{staticClass:"m-0 text-muted"},[t._t("default")],2)]),a("div",{staticClass:"col-md-6 text-right"},[t._t("extra")],2)])},o=[],n={name:"ContentHeader"},r=n,i=a("2877"),c=Object(i["a"])(r,s,o,!1,null,"adffe014",null);e["a"]=c.exports},"45b7":function(t,e,a){"use strict";var s=a("ed75"),o=a.n(s);o.a},"4ff9":function(t,e,a){},"5b67":function(t,e,a){"use strict";a.d(e,"a",(function(){return o}));var s=a("4360");function o(){const{dateFilter:t}=s["a"].getters;return"period"===t.type?{start_date:t.startDate||null,end_date:t.endDate||null,date_np:1}:{duration:t.type}}},"5c3e":function(t,e,a){"use strict";var s=a("a5d2"),o=a.n(s);o.a},"78b5":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("BackDrop",{staticClass:"d-flex justify-content-center align-items-center",attrs:{visible:t.visible},on:{close:t.onClose,closed:function(e){return t.$emit("closed")}}},[a("div",{staticClass:"custom-modal block custom-border-radius",class:{"pb-2":t.hideControls},style:t.modalWidth+"; "+t.modalMaxWidth+";"},[a("div",{staticClass:"block-header"},[a("h3",{staticClass:"block-title"},[t._v(" "+t._s(t.title)+" ")]),a("div",{staticClass:"block-options modal-close-btn mt-n2",on:{click:t.onClose}},[t._v(" Ã— ")])]),a("div",{staticClass:"px-4 py-2"},[t._t("default")],2),t.hideControls?t._e():a("div",{staticClass:"py-3 d-flex justify-content-end"},[t._t("footer",[a("Button",{staticClass:"mr-1",attrs:{color:"success",loading:t.loading},on:{click:function(e){return t.$emit("success")}}},[t._v(" OK ")]),a("Button",{staticClass:"ml-1",attrs:{color:"danger"},on:{click:t.onClose}},[t._v(" Close ")])])],2)])])},o=[],n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.isBackdropShown?a("div",{staticClass:"backdrop",class:t.animationType},[t._t("default")],2):t._e()},r=[],i={name:"BackDrop",props:{visible:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}}},data(){return{animationType:"fade-in",isBackdropShown:!1}},watch:{visible:{handler(t){return t?this.showBackDrop():this.hideBackDrop()},immediate:!0}},methods:{showBackDrop(){this.animationType="fade-in",this.isBackdropShown=!0},hideBackDrop(){this.animationType="fade-out",setTimeout(()=>{this.isBackdropShown=!1,this.$emit("closed")},150)}}},c=i,l=(a("5c3e"),a("2877")),d=Object(l["a"])(c,n,r,!1,null,"6c8f4972",null),u=d.exports,p=a("ad4f"),f={name:"Modal",components:{BackDrop:u,Button:p["a"]},props:{title:{type:String,default:"Title"},width:{type:[Number,String],default:null},maxWidth:{type:[Number,String],default:null},visible:{type:Boolean,default:!1},hideControls:{type:Boolean,default:!1},loading:{type:Boolean,default:!1}},computed:{modalWidth(){const{width:t}=this;return t?`width: ${t}vw;`:""},modalMaxWidth(){const{maxWidth:t}=this;return t?`max-width: ${t}vw;`:""}},methods:{onClose(){this.$emit("close")}}},h=f,v=(a("9dc3"),Object(l["a"])(h,s,o,!1,null,"01daf38d",null));e["a"]=v.exports},"7ede":function(t,e,a){"use strict";a.d(e,"d",(function(){return c})),a.d(e,"b",(function(){return l})),a.d(e,"a",(function(){return d})),a.d(e,"e",(function(){return u})),a.d(e,"c",(function(){return p}));var s=a("5530"),o=a("15fd"),n=a("9819"),r=a("5b67");function i(t){return t.start||t.end?{min_amount:t.start||0,max_amount:t.end||null}:{}}function c(t={amountRange:{}}){const{collectorId:e,amountRange:a}=t,c=Object(o["a"])(t,["collectorId","amountRange"]);return Object(n["a"])({url:"transactions",method:"get",cancelPrevious:!0,params:Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])({},c),Object(r["a"])()),i(a)),{},{collector_id:e})})}function l(t){return Object(n["a"])({url:"transactions",method:"post",data:t})}function d(t,e){return Object(n["a"])({url:`transactions/${t}/approve`,method:"patch",data:e})}function u(t){return Object(n["a"])({url:"transaction/import-amounts",method:"patch",data:t})}function p(t){return Object(n["a"])({url:"transactions/export",method:"post",data:t})}},"9dc3":function(t,e,a){"use strict";var s=a("4ff9"),o=a.n(s);o.a},a5d2:function(t,e,a){},c2cd:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{class:{"position-relative":t.isLoading}},[t._t("default"),t.isLoading?a("div",{staticClass:"custom-border-radius dropshadow",style:{background:"rgba(255, 255, 255, "+t.opacity+")"}},[a("div",{staticClass:"loader d-flex justify-content-center align-items-center"},[a("div",{style:{width:"40px"}},[a("Loader")],1)])]):t._e()],2)])},o=[],n=a("9333"),r={name:"CardLoader",components:{Loader:n["a"]},props:{isLoading:{type:Boolean,default:!1},loadingMinHeight:{type:String,default:"0px"},opacity:{type:Number,default:1}}},i=r,c=(a("45b7"),a("2877")),l=Object(c["a"])(i,s,o,!1,null,"6ad3b29c",null);e["a"]=l.exports},ed75:function(t,e,a){},f4f7:function(t,e,a){"use strict";a.d(e,"a",(function(){return r})),a.d(e,"d",(function(){return i})),a.d(e,"e",(function(){return c})),a.d(e,"b",(function(){return l})),a.d(e,"c",(function(){return d}));var s=a("5530"),o=a("9819"),n=a("5b67");function r(){return Object(o["a"])({url:"aggregate/amounts",method:"get",params:Object(s["a"])({},Object(n["a"])()),cancelPrevious:!0})}function i(){return Object(o["a"])({url:"aggregate/collectors",method:"get",params:Object(s["a"])({per_page:7},Object(n["a"])()),cancelPrevious:!0})}function c(){return Object(o["a"])({url:"aggregate/customers",method:"get",params:Object(s["a"])({per_page:7},Object(n["a"])()),cancelPrevious:!0})}function l(){return Object(o["a"])({url:"aggregate/approvals",method:"get"})}function d(){return Object(o["a"])({url:"aggregate/billings",method:"get"})}}}]);